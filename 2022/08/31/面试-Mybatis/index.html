

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wei Shao">
  <meta name="keywords" content="">
  
    <meta name="description" content="åŸºç¡€è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis? ä¼˜ç‚¹ï¼šMybatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ç¨‹åºå‘˜ç›´æ¥ç¼–å†™åŸç”Ÿæ€ sqlï¼Œå¯ä»¥ä¸¥æ ¼æ§åˆ¶ sql æ‰§è¡Œæ€§èƒ½ï¼Œçµæ´»åº¦é«˜ã€‚MyBatis å¯ä»¥ä½¿ç”¨ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°† POJO æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ï¼Œé¿">
<meta property="og:type" content="article">
<meta property="og:title" content="é¢è¯•-Mybatis">
<meta property="og:url" content="https://weishao-996.github.io/2022/08/31/%E9%9D%A2%E8%AF%95-Mybatis/index.html">
<meta property="og:site_name" content="ğŸ”ğŸŸWeiBlog">
<meta property="og:description" content="åŸºç¡€è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis? ä¼˜ç‚¹ï¼šMybatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ç¨‹åºå‘˜ç›´æ¥ç¼–å†™åŸç”Ÿæ€ sqlï¼Œå¯ä»¥ä¸¥æ ¼æ§åˆ¶ sql æ‰§è¡Œæ€§èƒ½ï¼Œçµæ´»åº¦é«˜ã€‚MyBatis å¯ä»¥ä½¿ç”¨ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°† POJO æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ï¼Œé¿">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831124353772.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831124733088.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831125002543.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831130749515.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831150538063.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831155449848.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831155632178.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831165343833.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831172605851.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831172905299.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831185515276.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831212914015.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/c6d2a5c38b2e4e6fae3da740b37596f7.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/06ed9e43f8644ff7a40eca96c27f15c1.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/f954119fbd3944ebbeccba11d8ee1ad9.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/cc432713b29a465babe833106535ffe9.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/57ebea0ab2e34e3fb6a15c8916b65100.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/dae47bea7d764a45809d612ac0a62b71.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/3c6f0b1fb377457c867002bbf8546a40.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/d52366f288e940b2afbf51d5035db571.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901114614900.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901114627565.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901123812730.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901130322195.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901145328294.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901153231196.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901153540814.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901154447146.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901155803040.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901162602848.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901163556036.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901163645793.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/2600280-20220303161626997-395362475.png">
<meta property="og:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/2600280-20220303163713816-2112457012.png">
<meta property="article:published_time" content="2022-08-31T03:29:36.000Z">
<meta property="article:modified_time" content="2022-10-08T05:06:06.000Z">
<meta property="article:author" content="Wei Shao">
<meta property="article:tag" content="é¢è¯•">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://weishao-996.github.io/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831124353772.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>é¢è¯•-Mybatis - ğŸ”ğŸŸWeiBlog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"weishao-996.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"Java"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>å¨å°‘ã®Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg/iTab-6ozkzl.jfif') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="é¢è¯•-Mybatis"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-31 11:29" pubdate>
          2022å¹´8æœˆ31æ—¥ ä¸Šåˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    

    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">é¢è¯•-Mybatis</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis"><a href="#è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis" class="headerlink" title="è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis?"></a>è¯´è¯´ä»€ä¹ˆæ˜¯MyBatis?</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831124353772.png" srcset="/img/loading.gif" lazyload alt="image-20220831124353772"></p>
<p>ä¼˜ç‚¹ï¼š<br>Mybatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»ºstatement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ç¨‹åºå‘˜ç›´æ¥ç¼–å†™åŸç”Ÿæ€ sqlï¼Œå¯ä»¥ä¸¥æ ¼æ§åˆ¶ sql æ‰§è¡Œæ€§èƒ½ï¼Œçµæ´»åº¦é«˜ã€‚MyBatis å¯ä»¥ä½¿ç”¨ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°† POJO æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ï¼Œé¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚</p>
<p>ç¼ºç‚¹ï¼š<br>SQLè¯­å¥çš„ç¼–å†™å·¥ä½œé‡è¾ƒå¤§ï¼Œå°¤å…¶å½“å­—æ®µå¤šã€å…³è”è¡¨å¤šæ—¶ï¼Œå¯¹å¼€å‘äººå‘˜ç¼–å†™SQLè¯­å¥çš„åŠŸåº•æœ‰ä¸€å®šè¦æ±‚SQLè¯­å¥ä¾èµ–äºæ•°æ®åº“ï¼Œå¯¼è‡´æ•°æ®åº“ç§»æ¤æ€§å·®ï¼Œä¸èƒ½éšæ„æ›´æ¢æ•°æ®åº“ã€‚</p>
<h3 id="ORMæ˜¯ä»€ä¹ˆ"><a href="#ORMæ˜¯ä»€ä¹ˆ" class="headerlink" title="ORMæ˜¯ä»€ä¹ˆ?"></a>ORMæ˜¯ä»€ä¹ˆ?</h3><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831124733088.png" srcset="/img/loading.gif" lazyload alt="image-20220831124733088"></p>
<p>ORMï¼ˆObject Relational Mappingï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œæ˜¯ä¸€ç§ä¸ºäº†è§£å†³å…³ç³»å‹æ•°æ®åº“æ•°æ®ä¸ç®€å•Javaå¯¹è±¡ï¼ˆPOJOï¼‰çš„æ˜ å°„å…³ç³»çš„æŠ€æœ¯ã€‚ç®€å•æ¥è¯´ï¼ŒORMæ˜¯é€šè¿‡ä½¿ç”¨æè¿°å¯¹è±¡å’Œæ•°æ®åº“ä¹‹é—´æ˜ å°„çš„å…ƒæ•°æ®ï¼Œå°†ç¨‹åºä¸­çš„å¯¹è±¡è‡ªåŠ¨æŒä¹…åŒ–åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè¯´Mybatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¯´Mybatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¯´Mybatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¯´Mybatisæ˜¯åŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Ÿå®ƒä¸å…¨è‡ªåŠ¨çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ</h3><p>Hibernateå±äºå…¨è‡ªåŠ¨ORMæ˜ å°„å·¥å…·ï¼Œä½¿ç”¨HibernateæŸ¥è¯¢å…³è”å¯¹è±¡æˆ–è€…å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œå¯ä»¥æ ¹æ®å¯¹è±¡å…³ç³»æ¨¡å‹ç›´æ¥è·å–ï¼Œæ‰€ä»¥å®ƒæ˜¯å…¨è‡ªåŠ¨çš„ã€‚è€ŒMybatisåœ¨æŸ¥è¯¢å…³è”å¯¹è±¡æˆ–å…³è”é›†åˆå¯¹è±¡æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™SQLæ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œè¢«ç§°ä¹‹ä¸ºåŠè‡ªåŠ¨ORMæ˜ å°„å·¥å…·ã€‚</p>
<h3 id="JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ"><a href="#JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ" class="headerlink" title="JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ"></a>JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</h3><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831125002543.png" srcset="/img/loading.gif" lazyload alt="image-20220831125002543"></p>
<p>1 ã€æ•°æ®è¿æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹é€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½<br><strong>è§£å†³ï¼šåœ¨mybatis-config.xmlä¸­é…ç½®æ•°æ®é“¾æ¥æ± ï¼Œä½¿ç”¨è¿æ¥æ± ç»Ÿä¸€ç®¡ç†æ•°æ®åº“è¿æ¥ã€‚</strong><br>2 ã€sqlè¯­å¥å†™åœ¨ä»£ç ä¸­é€ æˆä»£ç ä¸æ˜“ç»´æŠ¤<br><strong>è§£å†³ï¼šå°†sqlè¯­å¥é…ç½®åœ¨XXXXmapper.xmlæ–‡ä»¶ä¸­ä¸javaä»£ç åˆ†ç¦»ã€‚</strong><br>3 ã€å‘sqlè¯­å¥ä¼ å‚æ•°éº»çƒ¦ï¼Œå› ä¸ºsqlè¯­å¥çš„whereæ¡ä»¶ä¸ä¸€å®šï¼Œå¯èƒ½å¤šä¹Ÿå¯èƒ½å°‘ï¼Œå ä½ç¬¦éœ€è¦å’Œå‚æ•°ä¸€ä¸€å¯¹åº”ã€‚<br><strong>è§£å†³ï¼š Mybatisè‡ªåŠ¨å°†javaå¯¹è±¡æ˜ å°„è‡³sqlè¯­å¥ã€‚</strong><br>4 ã€å¯¹ç»“æœé›†è§£æéº»çƒ¦ï¼Œsqlå˜åŒ–å¯¼è‡´è§£æä»£ç å˜åŒ–ï¼Œä¸”è§£æå‰éœ€è¦éå†ï¼Œå¦‚æœèƒ½å°†æ•°æ®åº“è®°å½•å°è£…æˆpojoå¯¹è±¡è§£ææ¯”è¾ƒæ–¹ä¾¿ã€‚<br><strong>è§£å†³ï¼šMybatisè‡ªåŠ¨å°†sqlæ‰§è¡Œç»“æœæ˜ å°„è‡³javaå¯¹è±¡ã€‚</strong></p>
<h2 id="Hibernate-å’Œ-MyBatis-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Hibernate-å’Œ-MyBatis-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Hibernate å’Œ MyBatis æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Hibernate å’Œ MyBatis æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p><strong>ç›¸åŒç‚¹</strong></p>
<p>éƒ½æ˜¯å¯¹jdbcçš„å°è£…ï¼Œéƒ½æ˜¯åº”ç”¨äºæŒä¹…å±‚çš„æ¡†æ¶ã€‚</p>
<p><strong>ä¸åŒç‚¹</strong></p>
<p><strong>æ˜ å°„å…³ç³»</strong><br>MyBatis æ˜¯ä¸€ä¸ªåŠè‡ªåŠ¨æ˜ å°„çš„æ¡†æ¶ï¼Œé…ç½®Javaå¯¹è±¡ä¸sqlè¯­å¥æ‰§è¡Œç»“æœçš„å¯¹åº”å…³ç³»ï¼Œå¤šè¡¨å…³è”å…³ç³»é…ç½®ç®€å•<br>Hibernate æ˜¯ä¸€ä¸ªå…¨è¡¨æ˜ å°„çš„æ¡†æ¶ï¼Œé…ç½®Javaå¯¹è±¡ä¸æ•°æ®åº“è¡¨çš„å¯¹åº”å…³ç³»ï¼Œå¤šè¡¨å…³è”å…³ç³»é…ç½®å¤æ‚</p>
<p><strong>SQLä¼˜åŒ–å’Œç§»æ¤æ€§</strong><br>Hibernate å¯¹SQLè¯­å¥å°è£…ï¼Œæä¾›äº†æ—¥å¿—ã€ç¼“å­˜ã€çº§è”ï¼ˆçº§è”æ¯” MyBatis å¼ºå¤§ï¼‰ç­‰ç‰¹æ€§ï¼Œæ­¤å¤–è¿˜æä¾› HQLï¼ˆHibernate Query Languageï¼‰æ“ä½œæ•°æ®åº“ï¼Œæ•°æ®åº“æ— å…³æ€§æ”¯æŒå¥½ï¼Œä½†ä¼šå¤šæ¶ˆè€—æ€§èƒ½ã€‚å¦‚æœé¡¹ç›®éœ€è¦æ”¯æŒå¤šç§æ•°æ®åº“ï¼Œä»£ç å¼€å‘é‡å°‘ï¼Œä½†SQLè¯­å¥ä¼˜åŒ–å›°éš¾ã€‚<br>MyBatis éœ€è¦æ‰‹åŠ¨ç¼–å†™ SQLï¼Œæ”¯æŒåŠ¨æ€ SQLã€å¤„ç†åˆ—è¡¨ã€åŠ¨æ€ç”Ÿæˆè¡¨åã€æ”¯æŒå­˜å‚¨è¿‡ç¨‹ã€‚å¼€å‘å·¥ä½œé‡ç›¸å¯¹å¤§äº›ã€‚ç›´æ¥ä½¿ç”¨SQLè¯­å¥æ“ä½œæ•°æ®åº“ï¼Œä¸æ”¯æŒæ•°æ®åº“æ— å…³æ€§ï¼Œä½†sqlè¯­å¥ä¼˜åŒ–å®¹æ˜“ã€‚</p>
<h3 id="MyBatiså’ŒHibernateçš„é€‚ç”¨åœºæ™¯"><a href="#MyBatiså’ŒHibernateçš„é€‚ç”¨åœºæ™¯" class="headerlink" title="MyBatiså’ŒHibernateçš„é€‚ç”¨åœºæ™¯?"></a>MyBatiså’ŒHibernateçš„é€‚ç”¨åœºæ™¯?</h3><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831130749515.png" srcset="/img/loading.gif" lazyload alt="image-20220831130749515"></p>
<ul>
<li>Hibernate æ˜¯æ ‡å‡†çš„ORMæ¡†æ¶ï¼ŒSQLç¼–å†™é‡è¾ƒå°‘ï¼Œä½†ä¸å¤Ÿçµæ´»ï¼Œé€‚åˆäºéœ€æ±‚ç›¸å¯¹ç¨³å®šï¼Œä¸­å°å‹çš„è½¯ä»¶é¡¹ç›®ï¼Œæ¯”å¦‚ï¼šåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿ</li>
<li>MyBatis æ˜¯åŠORMæ¡†æ¶ï¼Œéœ€è¦ç¼–å†™è¾ƒå¤šSQLï¼Œä½†æ˜¯æ¯”è¾ƒçµæ´»ï¼Œé€‚åˆäºéœ€æ±‚å˜åŒ–é¢‘ç¹ï¼Œå¿«é€Ÿè¿­ä»£çš„é¡¹ç›®ï¼Œæ¯”å¦‚ï¼šç”µå•†ç½‘ç«™</li>
</ul>
<h2 id="MyBatisä½¿ç”¨è¿‡ç¨‹ï¼Ÿç”Ÿå‘½å‘¨æœŸï¼Ÿ"><a href="#MyBatisä½¿ç”¨è¿‡ç¨‹ï¼Ÿç”Ÿå‘½å‘¨æœŸï¼Ÿ" class="headerlink" title="MyBatisä½¿ç”¨è¿‡ç¨‹ï¼Ÿç”Ÿå‘½å‘¨æœŸï¼Ÿ"></a>MyBatisä½¿ç”¨è¿‡ç¨‹ï¼Ÿç”Ÿå‘½å‘¨æœŸï¼Ÿ</h2><p>MyBatisåŸºæœ¬ä½¿ç”¨çš„è¿‡ç¨‹å¤§æ¦‚å¯ä»¥åˆ†ä¸ºè¿™ä¹ˆå‡ æ­¥ï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831150538063.png" srcset="/img/loading.gif" lazyload alt="image-20220831150538063"></p>
<p><strong>1 ã€ åˆ›å»ºSqlSessionFactory</strong></p>
<ul>
<li>å¯ä»¥ä»é…ç½®æˆ–è€…ç›´æ¥ç¼–ç æ¥åˆ›å»ºSqlSessionFactory</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"org/mybatis/example/mybatis-config.xml"</span><span class="token punctuation">;</span>
<span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span>
<span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><strong>2 ã€ é€šè¿‡SqlSessionFactoryåˆ›å»ºSqlSession</strong></p>
<ul>
<li>SqlSessionï¼ˆä¼šè¯ï¼‰å¯ä»¥ç†è§£ä¸ºç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">SqlSession</span> session <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><strong>3 ã€ é€šè¿‡sqlsessionæ‰§è¡Œæ•°æ®åº“æ“ä½œ</strong></p>
<ul>
<li>â€‹    å¯ä»¥é€šè¿‡ SqlSession å®ä¾‹æ¥ç›´æ¥æ‰§è¡Œå·²æ˜ å°„çš„ SQL è¯­å¥ï¼š</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Blog</span> blog <span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">Blog</span><span class="token punctuation">)</span>session<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token string">"org.mybatis.example.BlogMapper.selectBlog"</span><span class="token punctuation">,</span><span class="token number">101</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ul>
<li>â€‹    æ›´å¸¸ç”¨çš„æ–¹å¼æ˜¯å…ˆè·å–Mapper(æ˜ å°„)ï¼Œç„¶åå†æ‰§è¡ŒSQLè¯­å¥ï¼š</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">BlogMapper</span> mapper <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">BlogMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Blog</span> blog <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectBlog</span><span class="token punctuation">(</span> <span class="token number">101</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p><strong>4 ã€ è°ƒç”¨session.commit()æäº¤äº‹åŠ¡</strong></p>
<ul>
<li>å¦‚æœæ˜¯æ›´æ–°ã€åˆ é™¤è¯­å¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æäº¤ä¸€ä¸‹äº‹åŠ¡ã€‚</li>
</ul>
<p><strong>5 ã€ è°ƒç”¨session.close()å…³é—­ä¼šè¯</strong></p>
<ul>
<li>æœ€åä¸€å®šè¦è®°å¾—å…³é—­ä¼šè¯ã€‚</li>
</ul>
<h3 id="MyBatisç”Ÿå‘½å‘¨æœŸï¼Ÿ"><a href="#MyBatisç”Ÿå‘½å‘¨æœŸï¼Ÿ" class="headerlink" title="MyBatisç”Ÿå‘½å‘¨æœŸï¼Ÿ"></a>MyBatisç”Ÿå‘½å‘¨æœŸï¼Ÿ</h3><p>ä¸Šé¢æåˆ°äº†å‡ ä¸ªMyBatisçš„ç»„ä»¶ï¼Œä¸€èˆ¬è¯´çš„MyBatisç”Ÿå‘½å‘¨æœŸå°±æ˜¯è¿™äº›ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<ul>
<li><p><strong>SqlSessionFactoryBuilder</strong></p>
<ul>
<li>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚ å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸåªå­˜åœ¨äºæ–¹æ³•çš„å†…éƒ¨ã€‚</li>
</ul>
</li>
<li><p><strong>SqlSessionFactory</strong></p>
<ul>
<li>SqlSessionFactory æ˜¯ç”¨æ¥åˆ›å»ºSqlSessionçš„ï¼Œç›¸å½“äºä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œæ¯æ¬¡åˆ›å»ºSqlSessionFactoryéƒ½ä¼šä½¿ç”¨æ•°æ®åº“èµ„æºï¼Œå¤šæ¬¡åˆ›å»ºå’Œé”€æ¯æ˜¯å¯¹èµ„æºçš„æµªè´¹ã€‚æ‰€ä»¥SqlSessionFactoryæ˜¯åº”ç”¨çº§çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œä¸”åº”è¯¥æ˜¯å•ä¾‹çš„ã€‚</li>
</ul>
</li>
<li><p><strong>SqlSession</strong></p>
<ul>
<li>SqlSessionç›¸å½“äºJDBCä¸­çš„Connectionï¼ŒSqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ¬¡è¯·æ±‚æˆ–ä¸€ä¸ªæ–¹æ³•ã€‚</li>
</ul>
</li>
<li><p><strong>Mapper</strong></p>
<ul>
<li>æ˜ å°„å™¨æ˜¯ä¸€äº›ç»‘å®šæ˜ å°„è¯­å¥çš„æ¥åˆã€‚æ˜ å°„å™¨æ¥åˆçš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸåœ¨sqlsessionäº‹åŠ¡æ–¹æ³•ä¹‹å†…ï¼Œä¸€èˆ¬ä¼šæ§åˆ¶åœ¨æ–¹æ³•çº§ã€‚</li>
</ul>
</li>
</ul>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831155449848.png" srcset="/img/loading.gif" lazyload alt="image-20220831155449848"></p>
<p>å½“ç„¶ï¼Œä¸‡ç‰©çš†å¯é›†æˆSpringï¼ŒMyBatisé€šå¸¸ä¹Ÿæ˜¯å’ŒSpringé›†æˆä½¿ç”¨ï¼ŒSpringå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„ã€åŸºäºäº‹åŠ¡çš„ SqlSession å’Œæ˜ å°„å™¨ï¼Œå¹¶å°†å®ƒä»¬ç›´æ¥æ³¨å…¥åˆ°æˆ‘ä»¬çš„ bean ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒå®ƒä»¬çš„åˆ›å»ºè¿‡ç¨‹å’Œç”Ÿå‘½å‘¨æœŸï¼Œé‚£å°±æ˜¯å¦å¤–çš„æ•…äº‹äº†ã€‚</p>
<h2 id="åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ"><a href="#åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ" class="headerlink" title="åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ"></a>åœ¨mapperä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831155632178.png" srcset="/img/loading.gif" lazyload alt="image-20220831155632178"></p>
<h3 id="æ–¹æ³•-1-ï¼šé¡ºåºä¼ å‚æ³•"><a href="#æ–¹æ³•-1-ï¼šé¡ºåºä¼ å‚æ³•" class="headerlink" title="æ–¹æ³• 1 ï¼šé¡ºåºä¼ å‚æ³•"></a>æ–¹æ³• 1 ï¼šé¡ºåºä¼ å‚æ³•</h3><figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectUser"</span> resultMap<span class="token operator">=</span><span class="token string">"UserResultMap"</span><span class="token operator">></span>
select <span class="token operator">*</span> from user
where user_name <span class="token operator">=</span> #<span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span> and dept_id <span class="token operator">=</span> #<span class="token punctuation">&#123;</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>#{}é‡Œé¢çš„æ•°å­—ä»£è¡¨ä¼ å…¥å‚æ•°çš„é¡ºåºã€‚</li>
<li>è¿™ç§æ–¹æ³•ä¸å»ºè®®ä½¿ç”¨ï¼Œsqlå±‚è¡¨è¾¾ä¸ç›´è§‚ï¼Œä¸”ä¸€æ—¦é¡ºåºè°ƒæ•´å®¹æ˜“å‡ºé”™ã€‚</li>
</ul>
<h3 id="æ–¹æ³•-2-ï¼š-Paramæ³¨è§£ä¼ å‚æ³•"><a href="#æ–¹æ³•-2-ï¼š-Paramæ³¨è§£ä¼ å‚æ³•" class="headerlink" title="æ–¹æ³• 2 ï¼š@Paramæ³¨è§£ä¼ å‚æ³•"></a>æ–¹æ³• 2 ï¼š@Paramæ³¨è§£ä¼ å‚æ³•</h3><figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"userName"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"deptId"</span><span class="token punctuation">)</span> deptId<span class="token punctuation">)</span>
    
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectUser"</span> resultMap<span class="token operator">=</span><span class="token string">"UserResultMap"</span><span class="token operator">></span>
select <span class="token operator">*</span> from user
where user_name <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>userName<span class="token punctuation">&#125;</span> and dept_id <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>deptId<span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£@Paramæ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°ã€‚</li>
<li>è¿™ç§æ–¹æ³•åœ¨å‚æ•°ä¸å¤šçš„æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒç›´è§‚çš„ï¼Œï¼ˆæ¨èä½¿ç”¨ï¼‰ã€‚</li>
</ul>
<h3 id="æ–¹æ³•-3-ï¼šMapä¼ å‚æ³•"><a href="#æ–¹æ³•-3-ï¼šMapä¼ å‚æ³•" class="headerlink" title="æ–¹æ³• 3 ï¼šMapä¼ å‚æ³•"></a><strong>æ–¹æ³• 3 ï¼šMapä¼ å‚æ³•</strong></h3><figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectUser"</span> parameterType<span class="token operator">=</span><span class="token string">"java.util.Map"</span> resultMap<span class="token operator">=</span><span class="token string">"UserResultMap"</span><span class="token operator">></span>
select <span class="token operator">*</span> from user
where user_name <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>userName<span class="token punctuation">&#125;</span> and dept_id <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>deptId<span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯Mapé‡Œé¢çš„keyåç§°ã€‚</li>
<li>è¿™ç§æ–¹æ³•é€‚åˆä¼ é€’å¤šä¸ªå‚æ•°ï¼Œä¸”å‚æ•°æ˜“å˜èƒ½çµæ´»ä¼ é€’çš„æƒ…å†µã€‚</li>
</ul>
<h3 id="æ–¹æ³•-4-ï¼šJava-Beanä¼ å‚æ³•"><a href="#æ–¹æ³•-4-ï¼šJava-Beanä¼ å‚æ³•" class="headerlink" title="æ–¹æ³• 4 ï¼šJava Beanä¼ å‚æ³•"></a><strong>æ–¹æ³• 4 ï¼šJava Beanä¼ å‚æ³•</strong></h3><figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectUser"</span> parameterType<span class="token operator">=</span><span class="token string">"com.jourwon.pojo.User"</span> resultMap<span class="token operator">=</span><span class="token string">"UserResultMap"</span><span class="token operator">></span>
	select <span class="token operator">*</span> from user
	where user_name <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>userName<span class="token punctuation">&#125;</span> and dept_id <span class="token operator">=</span> #<span class="token punctuation">&#123;</span>deptId<span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯Userç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚</li>
<li>è¿™ç§æ–¹æ³•ç›´è§‚ï¼Œéœ€è¦å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œæ‰©å±•ä¸å®¹æ˜“ï¼Œéœ€è¦åŠ å±æ€§ï¼Œä½†ä»£ç å¯è¯»æ€§å¼ºï¼Œä¸šåŠ¡é€»è¾‘å¤„ç†æ–¹ä¾¿ï¼Œæ¨èä½¿ç”¨ã€‚ï¼ˆæ¨èä½¿ç”¨ï¼‰ã€‚</li>
</ul>
<h2 id="å®ä½“ç±»å±æ€§åå’Œè¡¨ä¸­å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ"><a href="#å®ä½“ç±»å±æ€§åå’Œè¡¨ä¸­å­—æ®µåä¸ä¸€æ ·-ï¼Œæ€ä¹ˆåŠ" class="headerlink" title="å®ä½“ç±»å±æ€§åå’Œè¡¨ä¸­å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ?"></a>å®ä½“ç±»å±æ€§åå’Œè¡¨ä¸­å­—æ®µåä¸ä¸€æ · ï¼Œæ€ä¹ˆåŠ?</h2><ul>
<li>ç¬¬ 1 ç§ï¼š é€šè¿‡åœ¨æŸ¥è¯¢çš„SQLè¯­å¥ä¸­å®šä¹‰å­—æ®µåçš„åˆ«åï¼Œè®©å­—æ®µåçš„åˆ«åå’Œå®ä½“ç±»çš„å±æ€§åä¸€è‡´ã€‚</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getOrder<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span>
    <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.jourwon.pojo.Order<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    select order_id id, order_no orderno ,order_price price form
    orders where order_id=#&#123;id&#125;;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>ç¬¬ 2 ç§ï¼š é€šè¿‡resultMap ä¸­çš„<result>æ¥æ˜ å°„å­—æ®µåå’Œå®ä½“ç±»å±æ€§åçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getOrder<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderResultMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
select * from orders where order_id=#&#123;id&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.jourwon.pojo.Order<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderResultMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€“ç”¨idå±æ€§æ¥æ˜ å°„ä¸»é”®å­—æ®µâ€“</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€“ç”¨resultå±æ€§æ¥æ˜ å°„éä¸»é”®å­—æ®µï¼Œpropertyä¸ºå®ä½“ç±»å±æ€§åï¼Œcolumnä¸ºæ•°æ®åº“è¡¨ä¸­çš„å±æ€§â€“</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderno<span class="token punctuation">"</span></span> <span class="token attr-name">column</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_no<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_price<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>reslutMap</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Mybatisæ˜¯å¦å¯ä»¥æ˜ å°„Enumæšä¸¾ç±»ï¼Ÿ"><a href="#Mybatisæ˜¯å¦å¯ä»¥æ˜ å°„Enumæšä¸¾ç±»ï¼Ÿ" class="headerlink" title="Mybatisæ˜¯å¦å¯ä»¥æ˜ å°„Enumæšä¸¾ç±»ï¼Ÿ"></a>Mybatisæ˜¯å¦å¯ä»¥æ˜ å°„Enumæšä¸¾ç±»ï¼Ÿ</h2><ul>
<li>Mybatiså½“ç„¶å¯ä»¥æ˜ å°„æšä¸¾ç±»ï¼Œä¸å•å¯ä»¥æ˜ å°„æšä¸¾ç±»ï¼ŒMybatiså¯ä»¥æ˜ å°„ä»»ä½•å¯¹è±¡åˆ°è¡¨çš„ä¸€åˆ—ä¸Šã€‚æ˜ å°„æ–¹å¼ä¸ºè‡ªå®šä¹‰ä¸€ä¸ªTypeHandlerï¼Œå®ç°TypeHandlerçš„setParameter()å’ŒgetResult()æ¥å£æ–¹æ³•ã€‚</li>
<li>TypeHandleræœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯å®Œæˆä»javaTypeè‡³jdbcTypeçš„è½¬æ¢ï¼ŒäºŒæ˜¯å®ŒæˆjdbcTypeè‡³javaTypeçš„è½¬æ¢ï¼Œä½“ç°ä¸ºsetParameter()å’ŒgetResult()ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä»£è¡¨è®¾ç½®sqlé—®å·å ä½ç¬¦å‚æ•°å’Œè·å–åˆ—æŸ¥è¯¢ç»“æœã€‚</li>
</ul>
<h2 id="å’Œ-çš„åŒºåˆ«"><a href="#å’Œ-çš„åŒºåˆ«" class="headerlink" title="#{}å’Œ${}çš„åŒºåˆ«?"></a>#{}å’Œ${}çš„åŒºåˆ«?</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831165343833.png" srcset="/img/loading.gif" lazyload alt="image-20220831165343833"></p>
<ul>
<li>#{}æ˜¯å ä½ç¬¦ï¼Œé¢„ç¼–è¯‘å¤„ç†ï¼›${}æ˜¯æ‹¼æ¥ç¬¦ï¼Œå­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ²¡æœ‰é¢„ç¼–è¯‘å¤„ç†ã€‚</li>
<li>Mybatisåœ¨å¤„ç†#{}æ—¶ï¼Œ#{}ä¼ å…¥å‚æ•°æ˜¯ä»¥å­—ç¬¦ä¸²ä¼ å…¥ï¼Œä¼šå°†SQLä¸­çš„#{}æ›¿æ¢ä¸º?å·ï¼Œè°ƒç”¨PreparedStatementçš„setæ–¹æ³•æ¥èµ‹å€¼ã€‚</li>
<li>#{} å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢SQLæ³¨å…¥ï¼Œæé«˜ç³»ç»Ÿå®‰å…¨æ€§ï¼›${} ä¸èƒ½é˜²æ­¢SQL æ³¨å…¥</li>
<li>#{} çš„å˜é‡æ›¿æ¢æ˜¯åœ¨DBMS ä¸­ï¼›${} çš„å˜é‡æ›¿æ¢æ˜¯åœ¨ DBMS å¤–</li>
</ul>
<p>ä¾‹ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token comment">#&#123;userName&#125;ï¼›</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>è®¾userName=yuze</p>
<p>çœ‹æ—¥å¿—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è§£ææ—¶å°†#{userName}æ›¿æ¢æˆäº† <strong>ï¼Ÿ</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> ?<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>ç„¶åå†æŠŠyuzeæ”¾è¿›å»ï¼Œå¤–é¢åŠ ä¸Šå•å¼•å·</p>
<p>Mybatisåœ¨å¤„ç†çš„ æ—¶ å€™ å°± æ˜¯ æŠŠ {}çš„æ—¶å€™å°±æ˜¯æŠŠçš„æ—¶å€™å°±æ˜¯æŠŠ{}æ›¿æ¢æˆå˜é‡çš„å€¼ï¼Œè°ƒç”¨Statementæ¥èµ‹å€¼<br>å¦‚ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token comment">#&#123;userName&#125;ï¼›</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>è®¾userName=yuze</p>
<p>çœ‹æ—¥å¿—å¯ä»¥å‘ç°å°±æ˜¯ç›´æ¥æŠŠå€¼æ‹¼æ¥ä¸Šå»äº†</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> yuze<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>è¿™ææœ‰å¯èƒ½å‘ç”Ÿ<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=sql%E6%B3%A8%E5%85%A5&spm=1001.2101.3001.7020">sqlæ³¨å…¥</a>ï¼Œä¸‹é¢ä¸¾äº†ä¸€ä¸ªç®€å•çš„sqlæ³¨å…¥æ¡ˆä¾‹ </p>
<p>å½“ç”¨æˆ·ç™»å½•ï¼Œæˆ‘ä»¬éªŒè¯è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®æ—¶ç”¨è¿™ä¸ªsqlï¼š</p>
<p>username=yyy;password=123</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> username<span class="token operator">=</span>$&#123;username&#125; <span class="token operator">and</span> password<span class="token operator">=</span>$&#123;password&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>æ˜¾ç„¶è¿™æ¡sqlæ²¡é—®é¢˜å¯ä»¥æŸ¥å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœæœ‰äººä¸çŸ¥é“å¯†ç ä½†æ˜¯æƒ³ç™»å½•è´¦å·æ€ä¹ˆåŠ</p>
<p>æˆ‘ä»¬ä¸éœ€è¦å¡«å†™æ­£ç¡®çš„å¯†ç ï¼š</p>
<p>å¯†ç è¾“å…¥1 or 1=1ï¼Œsqlæ‰§è¡Œçš„å…¶å®æ˜¯</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'yyy'</span> <span class="token operator">and</span> password<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">or</span> <span class="token number">1</span> <span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>#{}çš„å˜é‡æ›¿æ¢æ˜¯åœ¨DBMSä¸­ã€å˜é‡æ›¿æ¢åï¼Œ#{}å¯¹åº”çš„å˜é‡è‡ªåŠ¨åŠ ä¸Šå•å¼•å·</p>
<p>${}çš„å˜é‡æ›¿æ¢æ˜¯åœ¨DBMSå¤–,å˜é‡æ›¿æ¢å ï¼Œ{}çš„å˜é‡æ›¿æ¢æ˜¯åœ¨DBMSå¤–ã€å˜é‡æ›¿æ¢åï¼Œçš„å˜é‡æ›¿æ¢æ˜¯åœ¨DBMSå¤–ã€å˜é‡æ›¿æ¢åï¼Œ{}å¯¹åº”çš„å˜é‡ä¸ä¼šåŠ ä¸Šå•å¼•å·</p>
<p>ä½¿ç”¨#{}å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢sqlæ³¨å…¥ï¼Œæé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§</p>
<h2 id="æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™"><a href="#æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?"></a>æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥è¯¥æ€ä¹ˆå†™?</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831172605851.png" srcset="/img/loading.gif" lazyload alt="image-20220831172605851"></p>
<p>1 â€™**%${question}%**â€™ å¯èƒ½å¼•èµ·SQLæ³¨å…¥ï¼Œä¸æ¨è<br>2 â€œ%â€#{question}â€%â€ æ³¨æ„ï¼šå› ä¸º#{â€¦}è§£ææˆsqlè¯­å¥æ—¶å€™ï¼Œä¼šåœ¨å˜é‡å¤–ä¾§è‡ªåŠ¨åŠ å•å¼•å·â€™â€™ï¼Œæ‰€ä»¥è¿™é‡Œ % éœ€è¦ä½¿ç”¨åŒå¼•å·â€ â€œï¼Œä¸èƒ½ä½¿ç”¨å•å¼•å· â€™ â€˜ï¼Œä¸ç„¶ä¼šæŸ¥ä¸åˆ°ä»»ä½•ç»“æœã€‚<br>3 CONCAT(â€™%â€™,#{question},â€™%â€™) ä½¿ç”¨CONCAT()å‡½æ•°ï¼Œï¼ˆæ¨èâœ¨ï¼‰<br>4 ä½¿ç”¨bindæ ‡ç­¾ï¼ˆä¸æ¨èï¼‰</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>listUserLikeUsername<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.jourwon.pojo.User<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bind</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pattern<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>%' + username + '%'<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
select id,sex,age,username,password from person where username LIKE #
&#123;pattern&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Mybatisèƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ"><a href="#Mybatisèƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ" class="headerlink" title="Mybatisèƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ"></a>Mybatisèƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ</h2><p>å½“ç„¶å¯ä»¥ï¼Œä¸æ­¢æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢ï¼Œè¿˜æ”¯æŒå¤šå¯¹å¤šã€å¤šå¯¹ä¸€çš„å…³è”æŸ¥è¯¢ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831172905299.png" srcset="/img/loading.gif" lazyload alt="image-20220831172905299"></p>
<ul>
<li><p><strong>ä¸€å¯¹ä¸€<association></strong></p>
<p>æ¯”å¦‚è®¢å•å’Œæ”¯ä»˜æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œè¿™ç§å…³è”çš„å®ç°ï¼š</p>
<p>å®ä½“ç±»:</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> orderId<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> orderDesc<span class="token punctuation">;</span>
    <span class="token comment">/**
    * æ”¯ä»˜å¯¹è±¡
    */</span>
	<span class="token keyword">private</span> <span class="token class-name">Pay</span> pay<span class="token punctuation">;</span>
    <span class="token comment">//......</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>ç»“æœæ˜ å°„</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- è®¢å•resultMap --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>peopleResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cn.fighter3.entity.Order<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderDesc<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_desc<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token comment">&lt;!--ä¸€å¯¹ä¸€ç»“æœæ˜ å°„--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pay<span class="token punctuation">"</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cn.fighter3.entity.Pay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>payId<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pay_id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>æŸ¥è¯¢å°±æ˜¯æ™®é€šçš„å…³è”æŸ¥</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getTeacher<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getTeacherMap<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    select * from order o
    left join pay p on o.order_id=p.order_id
    where o.order_id=#&#123;orderId&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p><strong>ä¸€å¯¹å¤š<collection></strong><br>æ¯”å¦‚å•†å“åˆ†ç±»å’Œå•†å“ï¼Œæ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚<br>å®ä½“ç±»:</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> categoryId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> categoryName<span class="token punctuation">;</span>
    <span class="token comment">/**
    * å•†å“åˆ—è¡¨
    **/</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> products<span class="token punctuation">;</span>
    <span class="token comment">//......</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>ç»“æœæ˜ å°„</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Category<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryId<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category_id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryName<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category_name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token comment">&lt;!-- ä¸€å¯¹å¤šçš„å…³ç³» --></span>
    <span class="token comment">&lt;!-- property: æŒ‡çš„æ˜¯é›†åˆå±æ€§çš„å€¼, ofTypeï¼šæŒ‡çš„æ˜¯é›†åˆä¸­å…ƒç´ çš„ç±»
    å‹ --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>products<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Product<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product_id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productId<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productName<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productName<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>æŸ¥è¯¢</p>
<p>æŸ¥è¯¢å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å…³è”æŸ¥è¯¢</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- å…³è”æŸ¥è¯¢åˆ†ç±»å’Œäº§å“è¡¨ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>listCategory<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
select c.*, p.* from category_ c left join product_ p
on c.id = p.cid
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

</li>
</ul>
<h2 id="Mybatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ"><a href="#Mybatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ" class="headerlink" title="Mybatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ"></a>Mybatisæ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ</h2><ul>
<li><p>Mybatisæ”¯æŒassociationå…³è”å¯¹è±¡å’Œcollectionå…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ï¼ŒassociationæŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼ŒcollectionæŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚åœ¨Mybatisé…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½<strong>lazyLoadingEnabled</strong>=true|falseã€‚</p>
</li>
<li><p>å®ƒçš„åŸç†æ˜¯ï¼Œä½¿ç”¨CGLIBåˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨a.getB().getName()ï¼Œæ‹¦æˆªå™¨invoke()æ–¹æ³•å‘ç°a.getB()æ˜¯nullå€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è”Bå¯¹è±¡çš„sqlï¼ŒæŠŠBæŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨a.setB(b)ï¼Œäºæ˜¯açš„å¯¹è±¡bå±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆa.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚</p>
</li>
<li><p>å½“ç„¶äº†ï¼Œä¸å…‰æ˜¯Mybatisï¼Œå‡ ä¹æ‰€æœ‰çš„åŒ…æ‹¬Hibernateï¼Œæ”¯æŒå»¶è¿ŸåŠ è½½çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
</ul>
<h2 id="å¦‚ä½•è·å–ç”Ÿæˆçš„ä¸»é”®"><a href="#å¦‚ä½•è·å–ç”Ÿæˆçš„ä¸»é”®" class="headerlink" title="å¦‚ä½•è·å–ç”Ÿæˆçš„ä¸»é”®?"></a>å¦‚ä½•è·å–ç”Ÿæˆçš„ä¸»é”®?</h2><p>æ–°å¢æ ‡ç­¾ä¸­æ·»åŠ ï¼škeyProperty=â€ ID â€œ å³å¯</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insert<span class="token punctuation">"</span></span> <span class="token attr-name">useGeneratedKeys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userId<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
    insert into user(
    user_name, user_password, create_time)
    values(#&#123;userName&#125;, #&#123;userPassword&#125; , #&#123;createTime, jdbcType=
    TIMESTAMP&#125;)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>è¿™æ—¶å€™å°±å¯ä»¥å®Œæˆå›å¡«ä¸»é”®</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>getId<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<h2 id="MyBatisæ”¯æŒåŠ¨æ€SQLå—ï¼Ÿ"><a href="#MyBatisæ”¯æŒåŠ¨æ€SQLå—ï¼Ÿ" class="headerlink" title="MyBatisæ”¯æŒåŠ¨æ€SQLå—ï¼Ÿ"></a>MyBatisæ”¯æŒåŠ¨æ€SQLå—ï¼Ÿ</h2><p>MyBatisä¸­æœ‰ä¸€äº›æ”¯æŒåŠ¨æ€SQLçš„æ ‡ç­¾ï¼Œå®ƒä»¬çš„åŸç†æ˜¯ä½¿ç”¨OGNLä»SQLå‚æ•°å¯¹è±¡ä¸­è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œæ ¹æ®è¡¨è¾¾å¼çš„å€¼åŠ¨æ€æ‹¼æ¥SQLï¼Œä»¥æ­¤æ¥å®ŒæˆåŠ¨æ€SQLçš„åŠŸèƒ½ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831185515276.png" srcset="/img/loading.gif" lazyload alt="image-20220831185515276"></p>
<ul>
<li><p>if</p>
<p>æ ¹æ®æ¡ä»¶æ¥ç»„æˆwhereå­å¥</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>findActiveBlogWithTitleLike<span class="token punctuation">"</span></span><span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Blog<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    SELECT * FROM BLOG
    WHERE state = â€˜ACTIVEâ€™
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    AND title like #&#123;title&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>


</li>
</ul>
<ul>
<li><p>choose (when, otherwise)</p>
<p>è¿™ä¸ªå’ŒJava ä¸­çš„ switch è¯­å¥æœ‰ç‚¹åƒ</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>findActiveBlogLike<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Blog<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            AND title like #&#123;title&#125;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author != null and author.name != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                AND author_name like #&#123;author.name&#125;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>otherwise</span><span class="token punctuation">></span></span>
            AND featured = 1
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>otherwise</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>trim (where, set)</p>
<ul>
<li><p><where>å¯ä»¥ç”¨åœ¨æ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶éƒ½æ˜¯åŠ¨æ€çš„æƒ…å†µ</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>findActiveBlogLike<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Blog<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    SELECT * FROM BLOG
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>state != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        state = #&#123;state&#125;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        AND title like #&#123;title&#125;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author != null and author.name != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        AND author_name like #&#123;author.name&#125;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p><set> å¯ä»¥ç”¨åœ¨åŠ¨æ€æ›´æ–°çš„æ—¶å€™</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateAuthorIfNecessary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    update Author
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>username=#&#123;username&#125;,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>password=#&#123;password&#125;,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>email=#&#123;email&#125;,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bio != null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>bio=#&#123;bio&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">></span></span>
    where id=#&#123;id&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>foreach<br>çœ‹åˆ°åå­—å°±çŸ¥é“äº†ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å¾ªç¯çš„ï¼Œå¯ä»¥å¯¹é›†åˆè¿›è¡Œéå†</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectPostIn<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>domain.blog.Post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    SELECT *
    FROM POST P
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span>
				<span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ID in (<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                #&#123;item&#125;
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>



</li>
</ul>
</li>
</ul>
<h2 id="MyBatiså¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ"><a href="#MyBatiså¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ" class="headerlink" title="MyBatiså¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ"></a>MyBatiså¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220831212914015.png" srcset="/img/loading.gif" lazyload alt="image-20220831212914015"></p>
<p><strong>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨foreachæ ‡ç­¾</strong></p>
<p>foreachçš„ä¸»è¦ç”¨åœ¨æ„å»ºinæ¡ä»¶ä¸­ï¼Œå®ƒå¯ä»¥åœ¨SQLè¯­å¥ä¸­è¿›è¡Œè¿­ä»£ä¸€ä¸ªé›†åˆã€‚foreachæ ‡ç­¾çš„å±æ€§ä¸»è¦æœ‰itemï¼Œindexï¼Œcollectionï¼Œopenï¼Œseparatorï¼Œcloseã€‚</p>
<ul>
<li>item è¡¨ç¤ºé›†åˆä¸­æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œè¿­ä»£æ—¶çš„åˆ«åï¼Œéšä¾¿èµ·çš„å˜é‡åï¼›</li>
<li>index æŒ‡å®šä¸€ä¸ªåå­—ï¼Œç”¨äºè¡¨ç¤ºåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡è¿­ä»£åˆ°çš„ä½ç½®ï¼Œä¸å¸¸ç”¨ï¼›</li>
<li>open è¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆå¼€å§‹ï¼Œå¸¸ç”¨â€œ(â€ï¼›</li>
<li>separator è¡¨ç¤ºåœ¨æ¯æ¬¡è¿›è¡Œè¿­ä»£ä¹‹é—´ä»¥ä»€ä¹ˆç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå¸¸ç”¨â€œ,â€ï¼›</li>
<li>close è¡¨ç¤ºä»¥ä»€ä¹ˆç»“æŸï¼Œå¸¸ç”¨â€œ)â€ã€‚</li>
</ul>
<p>åœ¨ä½¿ç”¨<strong>foreach</strong>çš„æ—¶å€™æœ€å…³é”®çš„ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé”™çš„å°±æ˜¯<strong>collection</strong>å±æ€§ï¼Œè¯¥å±æ€§æ˜¯å¿…é¡»æŒ‡å®šçš„ï¼Œä½†æ˜¯åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œè¯¥å±æ€§çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ 3 ç§æƒ…å†µï¼š</p>
<p><strong>1.</strong> å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªListçš„æ—¶å€™ï¼Œcollectionå±æ€§å€¼ä¸ºlist<br><strong>2.</strong> å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªarrayæ•°ç»„çš„æ—¶å€™ï¼Œcollectionçš„å±æ€§å€¼ä¸ºarray<br><strong>3.</strong> å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯å¤šä¸ªçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠå®ƒä»¬å°è£…æˆä¸€ä¸ªMapäº†ï¼Œå½“ç„¶å•å‚æ•°ä¹Ÿå¯ä»¥å°è£…æˆmapï¼Œå®é™…ä¸Šå¦‚æœä½ åœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™ï¼Œåœ¨MyBatisé‡Œé¢ä¹Ÿæ˜¯ä¼šæŠŠå®ƒå°è£…æˆä¸€ä¸ªMapçš„ï¼Œmapçš„keyå°±æ˜¯å‚æ•°åï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™collectionå±æ€§å€¼å°±æ˜¯ä¼ å…¥çš„Listæˆ–arrayå¯¹è±¡åœ¨è‡ªå·±å°è£…çš„mapé‡Œé¢çš„key</p>
<p>çœ‹çœ‹æ‰¹é‡ä¿å­˜çš„ä¸¤ç§ç”¨æ³•ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- MySQLä¸‹æ‰¹é‡ä¿å­˜ï¼Œå¯ä»¥foreachéå† mysqlæ”¯æŒvalues(),(),()è¯­æ³• --></span> //æ¨èä½¿ç”¨
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addEmpsBatch<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    INSERT INTO emp(ename,gender,email,did)
    VALUES
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>emps<span class="token punctuation">"</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>emp<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        (#&#123;emp.eName&#125;,#&#123;emp.gender&#125;,#&#123;emp.email&#125;,#&#123;emp.dept.id&#125;)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- è¿™ç§æ–¹å¼éœ€è¦æ•°æ®åº“è¿æ¥å±æ€§allowMutiQueries=trueçš„æ”¯æŒ
å¦‚jdbc.url=jdbc:mysql://localhost:3306/mybatis?allowMultiQueries=true --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addEmpsBatch<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>emps<span class="token punctuation">"</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>emp<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        INSERT INTO emp(ename,gender,email,did)
        VALUES(#&#123;emp.eName&#125;,#&#123;emp.gender&#125;,#&#123;emp.email&#125;,#&#123;emp.dept.id&#125;)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><strong>ç¬¬äºŒç§æ–¹æ³•ï¼šä½¿ç”¨ExecutorType.BATCH</strong></p>
<p>Mybatiså†…ç½®çš„ExecutorTypeæœ‰ 3 ç§ï¼Œé»˜è®¤ä¸ºsimpleï¼Œè¯¥æ¨¡å¼ä¸‹å®ƒä¸ºæ¯ä¸ªè¯­å¥çš„æ‰§è¡Œåˆ›å»ºä¸€ä¸ªæ–°çš„é¢„å¤„ç†è¯­å¥ï¼Œå•æ¡æäº¤sqlï¼›è€Œbatchæ¨¡å¼é‡å¤ä½¿ç”¨å·²ç»é¢„å¤„ç†çš„è¯­å¥ï¼Œå¹¶ä¸”æ‰¹é‡æ‰§è¡Œæ‰€æœ‰æ›´æ–°è¯­å¥ï¼Œæ˜¾ç„¶batchæ€§èƒ½å°†æ›´ä¼˜ï¼› ä½†batchæ¨¡å¼ä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜ï¼Œæ¯”å¦‚åœ¨Insertæ“ä½œ<br>æ—¶ï¼Œåœ¨äº‹åŠ¡æ²¡æœ‰æäº¤ä¹‹å‰ï¼Œæ˜¯æ²¡æœ‰åŠæ³•è·å–åˆ°è‡ªå¢çš„idï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ä¸ç¬¦åˆä¸šåŠ¡çš„éœ€æ±‚ã€‚<br>å…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æ‰¹é‡ä¿å­˜æ–¹æ³•æµ‹è¯•</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">&#123;</span>
	<span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token function">getSqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//å¯ä»¥æ‰§è¡Œæ‰¹é‡æ“ä½œçš„sqlSession</span>
	<span class="token class-name">SqlSession</span> openSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token class-name">ExecutorType</span><span class="token punctuation">.</span><span class="token constant">BATCH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ‰¹é‡ä¿å­˜æ‰§è¡Œå‰æ—¶é—´</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">EmployeeMapper</span> mapper <span class="token operator">=</span> openSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            mapper<span class="token punctuation">.</span><span class="token function">addEmp</span><span class="token punctuation">(</span><span class="token keyword">new</span>
            <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   		<span class="token punctuation">&#125;</span>
		openSession<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//æ‰¹é‡ä¿å­˜æ‰§è¡Œåçš„æ—¶é—´</span>
    	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œæ—¶â»“"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//æ‰¹é‡ é¢„ç¼–è¯‘sqlä¸€æ¬¡==ã€‹è®¾ç½®å‚æ•°==ã€‹ 10000 æ¬¡==ã€‹æ‰§è¡Œ 1 æ¬¡ 677</span>
    	<span class="token comment">//éæ‰¹é‡ ï¼ˆé¢„ç¼–è¯‘=è®¾ç½®å‚æ•°=æ‰§è¡Œ ï¼‰==ã€‹ 10000 æ¬¡ 1121</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
	openSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>mapperå’Œmapper.xmlå¦‚ä¸‹</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EmployeeMapper</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">//æ‰¹é‡ä¿å­˜å‘˜å·¥</span>
	<span class="token class-name">Long</span> <span class="token function">addEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.jourwon.mapper.EmployeeMapper<span class="token punctuation">"</span></span>
    <span class="token attr-name">&lt;!--æ‰¹é‡ä¿å­˜å‘˜å·¥</span> <span class="token attr-name">--</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addEmp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        insert into employee(lastName,email,gender)
        values(#&#123;lastName&#125;,#&#123;email&#125;,#&#123;gender&#125;)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="MyBatisä¸­ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¯¦è§£"><a href="#MyBatisä¸­ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¯¦è§£" class="headerlink" title="MyBatisä¸­ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¯¦è§£"></a>MyBatisä¸­ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜è¯¦è§£</h2><h3 id="ç¼“å­˜çš„ä½œç”¨"><a href="#ç¼“å­˜çš„ä½œç”¨" class="headerlink" title="ç¼“å­˜çš„ä½œç”¨"></a>ç¼“å­˜çš„ä½œç”¨</h3><p>é¦–å…ˆç¼“å­˜çš„åˆç†ä½¿ç”¨æ˜¯ä¼˜åŒ–ä¸­æœ€å¸¸è§çš„ï¼Œå°†ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®æ”¾å…¥ç¼“å­˜ä¸­ï¼Œä¸‹æ¬¡ä½¿ç”¨æ—¶ä¸å¿…ä»æ•°æ®åº“æŸ¥è¯¢ï¼Œè€Œæ˜¯ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ï¼Œé¿å…é¢‘ç¹æ“ä½œæ•°æ®åº“ï¼Œå‡è½»æ•°æ®çš„å‹åŠ›ï¼ŒåŒæ—¶æé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜"></a>ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜</h3><p>BSæ¶æ„é‡Œé¢ï¼Œç”¨æˆ·çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œå…¶ä¸­æŸ¥è¯¢çš„æ“ä½œæ˜¯æœ€å¤šçš„ï¼Œä½†å¦‚æœç”¨æˆ·æƒ³è¦æŸä¸ªæ•°æ®æ—¶æ¯æ¬¡éƒ½å»æ•°æ®åº“æŸ¥è¯¢ï¼Œè¿™æ— ç–‘ä¼šå¢åŠ æ•°æ®åº“çš„å‹åŠ›ï¼Œè€Œä¸”è·å–æ—¶é—´æ•ˆç‡ä¹Ÿä¼šé™ä½ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç¼“å­˜åº”ç”¨è€Œç”Ÿï¼Œä½¿ç”¨äº†ç¼“å­˜ä¹‹åï¼ŒæœåŠ¡å™¨åªéœ€è¦æŸ¥è¯¢ä¸€æ¬¡æ•°æ®åº“ï¼Œç„¶åå°†æ•°æ®ä¿å­˜åˆ°æœåŠ¡å™¨ä¸»æœºçš„å†…å­˜ä¸­ï¼Œä»¥åè¯»å–æ—¶å°±ç›´æ¥å–å†…å­˜ä¸­çš„æ•°æ®ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½æŸ¥æ•°æ®åº“ï¼Œè¿™ç§æ–¹æ¡ˆé™¤äº†é™ä½æ•°æ®åº“å‹åŠ›ä¹‹å¤–ï¼Œè¿˜æé«˜äº†å“åº”é€Ÿåº¦ï¼Œç®€ç›´ä¸€ç®­åŒé›•å“‡~</p>
<h3 id="ä¸€çº§ç¼“å­˜"><a href="#ä¸€çº§ç¼“å­˜" class="headerlink" title="ä¸€çº§ç¼“å­˜"></a>ä¸€çº§ç¼“å­˜</h3><p>ä¸€çº§ç¼“å­˜æ˜¯<strong>SqlSession</strong>çº§åˆ«çš„ç¼“å­˜ï¼Œåœ¨æ“ä½œæ•°æ®åº“æ—¶éœ€è¦æ„é€ SqlSessionå¯¹è±¡ï¼Œåœ¨å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„ç”¨äºå­˜å‚¨ç¼“å­˜æ•°æ®ã€‚ä¸åŒçš„sqlSessionä¹‹é—´çš„ç¼“å­˜æ•°æ®åŒºåŸŸæ˜¯<strong>äº’ç›¸ä¸å½±å“</strong>çš„ã€‚ä¹Ÿå°±æ˜¯ä»–åªèƒ½ä½œç”¨åœ¨åŒä¸€ä¸ª<strong>sqlSession</strong>ä¸­ï¼Œä¸åŒçš„<strong>sqlSession</strong>ä¸­çš„ç¼“å­˜æ˜¯äº’ç›¸ä¸èƒ½è¯»å–çš„ã€‚<br><strong>ä¸€çº§ç¼“å­˜çš„å·¥ä½œåŸç†ï¼š</strong><br>ä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªsqlSessionä¼šè¯é‡Œé¢çš„æ‰€æœ‰æŸ¥è¯¢æ“ä½œéƒ½ä¼šä¿å­˜åˆ°ç¼“å­˜ä¸­ï¼Œä¸€èˆ¬æ¥è¯´ä¸€ä¸ªè¯·æ±‚ä¸­çš„æ‰€æœ‰å¢åˆ æ”¹æŸ¥æ“ä½œéƒ½æ˜¯åœ¨åŒä¸€ä¸ªsqlSessioné‡Œé¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½æœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼Œå¦‚æœåŒä¸€ä¸ªsqlSessionä¼šè¯ä¸­2 ä¸ªæŸ¥è¯¢ä¸­é—´æœ‰ä¸€ä¸ª insert ã€updateæˆ–delete è¯­å¥ï¼Œé‚£ä¹ˆä¹‹å‰æŸ¥è¯¢çš„æ‰€æœ‰ç¼“å­˜éƒ½ä¼šæ¸…ç©ºï¼›<br><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/c6d2a5c38b2e4e6fae3da740b37596f7.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/06ed9e43f8644ff7a40eca96c27f15c1.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>1ã€ç”¨æˆ·å‘èµ·æŸ¥è¯¢è¯·æ±‚ï¼ŒæŸ¥è¯¢æŸæ¡æ•°æ®ï¼ŒsqlSessionå…ˆå»ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œæ˜¯å¦æœ‰è¯¥æ¡æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¯»å–å¹¶è¿”å›ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™éœ€è¦ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†æŸ¥è¯¢åˆ°çš„æ•°æ®æ”¾å…¥åˆ°ä¸€çº§ç¼“å­˜åŒºåŸŸï¼Œä¾›ä¸‹æ¬¡æŸ¥æ‰¾ä½¿ç”¨ã€‚</p>
<p>2ã€sqlSessionæ‰§è¡Œå¢åˆ æ”¹æ“ä½œå¹¶æ‰§è¡Œcommitæ“ä½œï¼Œåˆ™ä¼šæ¸…ç©ºç¼“å­˜ï¼Œè¿™æ ·åšçš„<strong>ç›®çš„æ˜¯é¿å…è„è¯»</strong>ã€‚</p>
<p>3ã€å¦‚æœcommitä¸æ¸…ç©ºç¼“å­˜ï¼Œä¼šæœ‰ä»¥ä¸‹åœºæ™¯ï¼šAæŸ¥è¯¢äº†æŸå•†å“åº“å­˜ä¸º10ä»¶ï¼Œå¹¶å°†10ä»¶åº“å­˜çš„æ•°æ®å­˜å…¥ç¼“å­˜ä¸­ï¼Œä¹‹åè¢«å®¢æˆ·ä¹°èµ°äº†10ä»¶ï¼Œæ•°æ®è¢«deleteäº†ï¼Œä½†æ˜¯ä¸‹æ¬¡æŸ¥è¯¢è¿™ä»¶å•†å“æ—¶ï¼Œå¹¶ä¸ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œè€Œæ˜¯ä»ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œå°±ä¼šå‡ºç°é”™è¯¯ã€‚</p>
<p>4ã€ç¤ºä¾‹ä»£ç </p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
 
        <span class="token comment">// åŠ è½½mybatisé…ç½®æ–‡ä»¶</span>
        <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">"config/configuration.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºæ•°æ®å·¥å‚</span>
        <span class="token class-name">SqlSessionFactoryBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
        <span class="token comment">// è·å–mapperæ¥å£å¯¹è±¡</span>
        <span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">// æŸ¥è¯¢ç¬¬ä¸€æ¬¡</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬äºŒæ¬¡æŸ¥è¯¢</span>
        <span class="token class-name">User</span> user1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸¤ä¸ªuserå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼š"</span><span class="token operator">+</span><span class="token punctuation">(</span>user <span class="token operator">==</span> user1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡Šæ”¾ä¼šè¯</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/f954119fbd3944ebbeccba11d8ee1ad9.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>æ ¹æ®ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œä»£ç ä¸­æ‰§è¡Œäº†2æ¬¡æŸ¥è¯¢ï¼Œ ä½†å®é™…è¿è¡Œæ—¶åªæŸ¥è¯¢äº†ä¸€æ¬¡æ•°æ®åº“ï¼Œç¬¬äºŒæ¬¡è·å–æ•°æ®æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ï¼Œå¹¶ä¸”2æ¬¡è¯»å–çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåˆ°è¿™é‡Œï¼Œä¸€çº§ç¼“å­˜å°±å·²ç»ç”Ÿæ•ˆäº†ï¼›</strong><br>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æµ‹è¯•ç¬¬äºŒç§æƒ…å†µ ï¼š<strong>æŸ¥è¯¢ -&gt; ä¿®æ”¹ -&gt; æŸ¥è¯¢</strong><br>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
 
        <span class="token comment">// åŠ è½½mybatisé…ç½®æ–‡ä»¶</span>
        <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">"config/configuration.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºæ•°æ®å·¥å‚</span>
        <span class="token class-name">SqlSessionFactoryBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
        <span class="token comment">// è·å–mapperæ¥å£å¯¹è±¡</span>
        <span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥è¯¢ç¬¬ä¸€æ¬¡</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¿®æ”¹</span>
        mapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬äºŒæ¬¡æŸ¥è¯¢</span>
        <span class="token class-name">User</span> user1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸¤ä¸ªuserå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼š"</span><span class="token operator">+</span><span class="token punctuation">(</span>user <span class="token operator">==</span> user1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡Šæ”¾ä¼šè¯</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/cc432713b29a465babe833106535ffe9.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æ§åˆ¶å°æ‰“å°äº†ä¸‰æ¬¡sql,å…¶ä¸­ç¬¬ä¸€ä¸ªæŸ¥è¯¢å’Œç¬¬ä¸‰ä¸ªæŸ¥è¯¢æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä½¿ç”¨ç¼“å­˜<strong>ï¼Œæ˜¯å› ä¸ºæ¯æ¬¡å¢åˆ æ”¹æ“ä½œéƒ½æœ‰å¯èƒ½ä¼šæ”¹å˜åŸæ¥çš„æ•°æ®ï¼Œæ‰€ä»¥å¿…é¡»åˆ·æ–°ç¼“å­˜</strong>ã€‚</p>
<h3 id="äºŒçº§ç¼“å­˜"><a href="#äºŒçº§ç¼“å­˜" class="headerlink" title="äºŒçº§ç¼“å­˜"></a>äºŒçº§ç¼“å­˜</h3><p><strong>äºŒçº§ç¼“å­˜æ˜¯mapperçº§åˆ«çš„ç¼“å­˜</strong>ï¼Œå¤šä¸ªSqlSessionå»æ“ä½œåŒä¸€ä¸ªMapperçš„sqlè¯­å¥ï¼Œ<strong>å¤šä¸ªSqlSessionå¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨SqlSessionçš„ã€‚äºŒçº§ç¼“å­˜çš„ä½œç”¨èŒƒå›´æ›´å¤§</strong>ã€‚</p>
<p>äºŒçº§ç¼“å­˜æµç¨‹å›¾ï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/57ebea0ab2e34e3fb6a15c8916b65100.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç¬¬ä¸€ç§é…ç½®æ–¹å¼</p>
<p>å•ä¸ªmapperé…ç½®ï¼Œä¸»éœ€è¦åœ¨éœ€è¦å¼€å¯äºŒçº§ç¼“å­˜çš„mapper.xmlæ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®å³å¯å¼€å¯ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- å¼€å¯å•ä¸ªmapperçš„äºŒçº§ç¼“å­˜ï¼Œä¹Ÿå«å…¨å±€ç¼“å­˜--></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cache</span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p>æ³¨æ„ä¸€å®šè¦åŠ åˆ°xxMapper.xmlçš„æ–‡ä»¶å†…ï¼Œåƒä¸‡ä¸è¦åŠ åˆ°[mybatis] çš„ä¸»é…ç½®æ–‡ä»¶é‡Œé¢äº†ï¼Œä¼šæŠ¥é”™çš„ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/dae47bea7d764a45809d612ac0a62b71.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç¬¬äºŒç§é…ç½®æ–¹å¼</p>
<p>æ‰€æœ‰çš„mapperéƒ½å¼€å¯äºŒçº§ç¼“å­˜ï¼Œåœ¨mybatis.xmlä¸»é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®å³å¯</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
     <span class="token comment">&lt;!--  å¼€å¯æ‰€æœ‰mapperçš„äºŒçº§ç¼“å­˜ --></span>
     <span class="token comment">&lt;!--&lt;setting name="cacheEnabled" value="true" />--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/3c6f0b1fb377457c867002bbf8546a40.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    
  	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// åŠ è½½mybatisé…ç½®æ–‡ä»¶</span>
        <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">"config/configuration.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºæ•°æ®å·¥å‚</span>
        <span class="token class-name">SqlSessionFactoryBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬ä¸€ä¸ªä¼šè¯</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–ä¼šè¯ä¸€çš„mapperæ¥å£å¯¹è±¡</span>
        <span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬ä¸€æ¬¡æŸ¥è¯¢</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡Šæ”¾ç¬¬ä¸€ä¸ªä¼šè¯</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬äºŒä¸ªä¼šè¯</span>
        <span class="token class-name">SqlSession</span> sqlSession2 <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–ä¼šè¯äºŒçš„mapperæ¥å£å¯¹è±¡</span>
        <span class="token class-name">UserMapper</span> mapper2 <span class="token operator">=</span> sqlSession2<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬äºŒæ¬¡æŸ¥è¯¢</span>
        <span class="token class-name">User</span> user1 <span class="token operator">=</span> mapper2<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"3rfrf34r34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é‡Šæ”¾ç¬¬äºŒä¸ªä¼šè¯</span>
        sqlSession2<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession2<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>æ‰“å°ç»“æœï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/d52366f288e940b2afbf51d5035db571.png" srcset="/img/loading.gif" lazyload alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>æ‰“å°ç»“æœå¾ˆæ˜æ˜¾ï¼Œ2æ¬¡æŸ¥è¯¢ï¼Œä½†æ˜¯æ—¥å¿—æ˜¾ç¤ºåªæŸ¥è¯¢äº†ä¸€æ¬¡æ•°æ®åº“ï¼Œ ç¬¬äºŒæ¬¡æ˜¯ä»ç¼“å­˜ä¸­è·å–çš„æ•°æ®ï¼Œè‡³æ­¤ï¼ŒäºŒçº§ç¼“å­˜å·²å¼€å¯ï¼</strong></p>
<p>æ€»ç»“ï¼š</p>
<p><strong>1.</strong> ä¸€çº§ç¼“å­˜: åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸ºSqlSessionï¼Œå„ä¸ªSqlSessionä¹‹é—´çš„ç¼“å­˜ç›¸äº’éš”ç¦»ï¼Œå½“Session flush æˆ– close ä¹‹åï¼Œè¯¥ SqlSession ä¸­çš„æ‰€æœ‰Cache å°±å°†æ¸…ç©ºï¼ŒMyBatisé»˜è®¤æ‰“å¼€ä¸€çº§ç¼“å­˜ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901114614900.png" srcset="/img/loading.gif" lazyload alt="image-20220901114614900"></p>
<p><strong>2.</strong> äºŒçº§ç¼“å­˜ä¸ä¸€çº§ç¼“å­˜å…¶æœºåˆ¶ç›¸åŒï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨ PerpetualCacheï¼ŒHashMap å­˜å‚¨ï¼Œä¸åŒä¹‹å¤„åœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper(Namespace)ï¼Œå¯ä»¥åœ¨å¤šä¸ªSqlSessionä¹‹é—´å…±äº«ï¼Œå¹¶ä¸”å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚é»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç°Serializableåºåˆ—åŒ–æ¥åˆ(å¯ç”¨æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€),å¯åœ¨å®ƒçš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½®ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901114627565.png" srcset="/img/loading.gif" lazyload alt="image-20220901114627565"></p>
<h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><h2 id="èƒ½è¯´è¯´MyBatisçš„å·¥ä½œåŸç†å—ï¼Ÿ"><a href="#èƒ½è¯´è¯´MyBatisçš„å·¥ä½œåŸç†å—ï¼Ÿ" class="headerlink" title="èƒ½è¯´è¯´MyBatisçš„å·¥ä½œåŸç†å—ï¼Ÿ"></a>èƒ½è¯´è¯´MyBatisçš„å·¥ä½œåŸç†å—ï¼Ÿ</h2><p>æˆ‘ä»¬å·²ç»å¤§æ¦‚çŸ¥é“äº†MyBatisçš„å·¥ä½œæµç¨‹ï¼ŒæŒ‰å·¥ä½œåŸç†ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤å¤§æ­¥ï¼š<strong>ç”Ÿæˆä¼šè¯å·¥å‚ã€ä¼šè¯è¿è¡Œ</strong>ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901123812730.png" srcset="/img/loading.gif" lazyload alt="image-20220901123812730"></p>
<p>MyBatisæ˜¯ä¸€ä¸ªæˆç†Ÿçš„æ¡†æ¶ï¼Œç¯‡å¹…é™åˆ¶ï¼Œè¿™é‡ŒæŠ“å¤§æ”¾å°ï¼Œæ¥çœ‹çœ‹å®ƒçš„ä¸»è¦å·¥ä½œæµç¨‹ã€‚</p>
<h3 id="æ„å»ºä¼šè¯å·¥å‚"><a href="#æ„å»ºä¼šè¯å·¥å‚" class="headerlink" title="æ„å»ºä¼šè¯å·¥å‚"></a>æ„å»ºä¼šè¯å·¥å‚</h3><p>æ„é€ ä¼šè¯å·¥å‚ä¹Ÿå¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901130322195.png" srcset="/img/loading.gif" lazyload alt="image-20220901130322195"></p>
<ul>
<li>è·å–é…ç½®</li>
</ul>
<p>è·å–é…ç½®è¿™ä¸€æ­¥ç»è¿‡äº†å‡ æ­¥è½¬åŒ–ï¼Œæœ€ç»ˆç”±ç”Ÿæˆäº†ä¸€ä¸ªé…ç½®ç±»<strong>Configuration</strong>å®ä¾‹ï¼Œè¿™ä¸ªé…ç½®ç±»å®ä¾‹éå¸¸é‡è¦ï¼Œä¸»è¦ä½œç”¨åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€‹    è¯»å–é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬<strong>åŸºç¡€é…ç½®æ–‡ä»¶å’Œæ˜ å°„æ–‡ä»¶</strong></li>
<li>â€‹    åˆå§‹åŒ–åŸºç¡€é…ç½®ï¼Œæ¯”å¦‚MyBatisçš„åˆ«åï¼Œè¿˜æœ‰å…¶å®ƒçš„ä¸€äº›é‡è¦çš„<strong>ç±»å¯¹è±¡ï¼Œåƒæ’ä»¶ã€æ˜ å°„å™¨ã€ObjectFactory</strong>ç­‰ç­‰</li>
<li>â€‹    æä¾›ä¸€ä¸ªå•ä¾‹ï¼Œä½œä¸ºä¼šè¯å·¥å‚æ„å»ºçš„é‡è¦å‚æ•°</li>
<li>â€‹    å®ƒçš„æ„å»ºè¿‡ç¨‹ä¹Ÿä¼šåˆå§‹åŒ–ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚æ•°æ®æº</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">Reader</span> reader<span class="token punctuation">,</span> <span class="token class-name">String</span> environment<span class="token punctuation">,</span><span class="token class-name">Properties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">SqlSessionFactory</span> var5<span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥å¼‚å¸¸å¤„ç†</span>
    <span class="token comment">//xmlé…ç½®æ„å»ºå™¨</span>
    <span class="token class-name">XMLConfigBuilder</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLConfigBuilder</span><span class="token punctuation">(</span>reader<span class="token punctuation">,</span>environment<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é€šè¿‡è½¬åŒ–çš„Configurationæ„å»ºSqlSessionFactory</span>
    var5 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li><p>æ„å»ºSqlSessionFactory</p>
<p>SqlSessionFactoryåªæ˜¯ä¸€ä¸ªæ¥åˆï¼Œæ„å»ºå‡ºæ¥çš„å®é™…ä¸Šæ˜¯å®ƒçš„å®ç°ç±»çš„å®ä¾‹ï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨çš„éƒ½æ˜¯å®ƒçš„å®ç°ç±»DefaultSqlSessionFactoryï¼Œ</p>
</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> config<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DefaultSqlSessionFactory</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="ä¼šè¯è¿è¡Œ"><a href="#ä¼šè¯è¿è¡Œ" class="headerlink" title="ä¼šè¯è¿è¡Œ"></a>ä¼šè¯è¿è¡Œ</h3><p>ä¼šè¯è¿è¡Œæ˜¯MyBatisæœ€å¤æ‚çš„éƒ¨åˆ†ï¼Œå®ƒçš„è¿è¡Œç¦»ä¸å¼€å››å¤§ç»„ä»¶çš„é…åˆï¼š<img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901145328294.png" srcset="/img/loading.gif" lazyload alt="image-20220901145328294"></p>
<ul>
<li><strong>Executorï¼ˆæ‰§è¡Œå™¨ï¼‰</strong><br>Executorèµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ï¼ŒSqlSessionåªæ˜¯ä¸€ä¸ªé—¨é¢ï¼Œç›¸å½“äºå®¢æœï¼ŒçœŸæ­£å¹²æ´»çš„æ˜¯æ˜¯Executorï¼Œå°±åƒæ˜¯é»˜é»˜æ— é—»çš„å·¥ç¨‹å¸ˆã€‚å®ƒæä¾›äº†ç›¸åº”çš„æŸ¥è¯¢å’Œæ›´æ–°æ–¹æ³•ï¼Œä»¥åŠäº‹åŠ¡æ–¹æ³•ã€‚</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Environment</span> environment <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">TransactionFactory</span> transactionFactory <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTransactionFactoryFromEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
tx <span class="token operator">=</span> transactionFactory<span class="token punctuation">.</span><span class="token function">newTransaction</span><span class="token punctuation">(</span>environment<span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> level<span class="token punctuation">,</span> autoCommit<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//é€šè¿‡Configurationåˆ›å»ºexecutor</span>
<span class="token class-name">Executor</span> executor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span><span class="token function">newExecutor</span><span class="token punctuation">(</span>tx<span class="token punctuation">,</span>execType<span class="token punctuation">)</span><span class="token punctuation">;</span>
var8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultSqlSession</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>configuration<span class="token punctuation">,</span> executor<span class="token punctuation">,</span>autoCommit<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>StatementHandlerï¼ˆæ•°æ®åº“ä¼šè¯å™¨ï¼‰<br>StatementHandlerï¼Œé¡¾åæ€ä¹‰ï¼Œå¤„ç†æ•°æ®åº“ä¼šè¯çš„ã€‚æˆ‘ä»¬ä»¥SimpleExecutorä¸ºä¾‹ï¼Œçœ‹ä¸€ä¸‹å®ƒçš„æŸ¥è¯¢æ–¹æ³•ï¼Œå…ˆç”Ÿæˆäº†ä¸€ä¸ªStatementHandlerå®ä¾‹ï¼Œå†æ‹¿è¿™ä¸ªhandlerå»æ‰§è¡Œqueryã€‚</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token function">doQuery</span><span class="token punctuation">(</span><span class="token class-name">MappedStatement</span> ms<span class="token punctuation">,</span> <span class="token class-name">Object</span> parameter<span class="token punctuation">,</span>
<span class="token class-name">RowBounds</span> rowBounds<span class="token punctuation">,</span> <span class="token class-name">ResultHandler</span> resultHandler<span class="token punctuation">,</span> <span class="token class-name">BoundSql</span> boundSql<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">Statement</span> stmt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> var9<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> ms<span class="token punctuation">.</span><span class="token function">getConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StatementHandler</span> handler <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">newStatementHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>wrapper<span class="token punctuation">,</span> ms<span class="token punctuation">,</span> parameter<span class="token punctuation">,</span>rowBounds<span class="token punctuation">,</span>
        resultHandler<span class="token punctuation">,</span> boundSql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>handler<span class="token punctuation">,</span>ms<span class="token punctuation">.</span><span class="token function">getStatementLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        var9 <span class="token operator">=</span> handler<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> resultHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeStatement</span><span class="token punctuation">(</span>stmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token keyword">return</span> var9<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>å†ä»¥æœ€å¸¸ç”¨çš„PreparedStatementHandlerçœ‹ä¸€ä¸‹å®ƒçš„queryæ–¹æ³•ï¼Œå…¶å®åœ¨ä¸Šé¢çš„prepareStatementå·²ç»å¯¹å‚æ•°è¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†ï¼Œåˆ°äº†è¿™é‡Œï¼Œå°±ç›´æ¥æ‰§è¡Œsqlï¼Œä½¿ç”¨ResultHandlerå¤„ç†è¿”å›ç»“æœã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">ResultHandler</span> resultHandler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span><span class="token punctuation">)</span>statement<span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resultSetHandler<span class="token punctuation">.</span><span class="token function">handleResultSets</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>ParameterHandler ï¼ˆå‚æ•°å¤„ç†å™¨ï¼‰<br>PreparedStatementHandleré‡Œå¯¹sqlè¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parameterize</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> statement<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>parameterHandler<span class="token punctuation">.</span><span class="token function">setParameters</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span><span class="token punctuation">)</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<p>è¿™é‡Œç”¨çš„å°±æ˜¯ParameterHandlerï¼ŒsetParametersçš„ä½œç”¨å°±æ˜¯è®¾ç½®é¢„ç¼–è¯‘SQLè¯­å¥çš„å‚æ•°ã€‚é‡Œé¢è¿˜ä¼šç”¨åˆ°typeHandlerç±»å‹å¤„ç†å™¨ï¼Œå¯¹ç±»å‹è¿›è¡Œå¤„ç†ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ParameterHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Object</span> <span class="token function">getParameterObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setParameters</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li><p>ResultSetHandlerï¼ˆç»“æœå¤„ç†å™¨ï¼‰</p>
<p>æˆ‘ä»¬å‰é¢ä¹Ÿçœ‹åˆ°äº†ï¼Œæœ€åçš„ç»“æœè¦é€šè¿‡ResultSetHandleræ¥è¿›è¡Œå¤„ç†ï¼ŒhandleResultSetsè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥åŒ…è£…ç»“æœé›†çš„ã€‚Mybatisä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªDefaultResultSetHandlerï¼Œé€šå¸¸éƒ½æ˜¯ç”¨è¿™ä¸ªå®ç°ç±»å»è¿›è¡Œç»“æœçš„å¤„ç†çš„ã€‚</p>
</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ResultSetHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token function">handleResultSets</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">;</span>
    
    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token class-name">Cursor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token function">handleCursorResultSets</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">;</span>
    
    <span class="token keyword">void</span> <span class="token function">handleOutputParameters</span><span class="token punctuation">(</span><span class="token class-name">CallableStatement</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>å®ƒä¼šä½¿ç”¨typeHandleå¤„ç†ç±»å‹ï¼Œç„¶åç”¨ObjectFactoryæä¾›çš„è§„åˆ™ç»„è£…å¯¹è±¡ï¼Œè¿”å›ç»™è°ƒç”¨è€…ã€‚</p>
<p>æ•´ä½“ä¸Šæ€»ç»“ä¸€ä¸‹ä¼šè¯è¿è¡Œï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901153231196.png" srcset="/img/loading.gif" lazyload alt="image-20220901153231196"></p>
<p>æŠŠæ•´ä¸ªçš„â¼¯ä½œæµç¨‹ä¸²è”èµ·æ¥ï¼Œç®€å•æ€»ç»“â¼€ä¸‹ï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901153540814.png" srcset="/img/loading.gif" lazyload alt="image-20220901153540814"></p>
<p><strong>1.</strong> è¯»å– MyBatis é…ç½®æ–‡ä»¶â€”â€”<strong>mybatis-config.xml ã€åŠ è½½æ˜ å°„æ–‡ä»¶</strong>â€”â€”æ˜ å°„æ–‡ä»¶å³ SQL æ˜ å°„æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­é…ç½®äº†æ“ä½œæ•°æ®åº“çš„ SQL è¯­å¥ã€‚æœ€åç”Ÿæˆä¸€ä¸ª<strong>é…ç½®å¯¹è±¡</strong>ã€‚<br><strong>2.</strong> æ„é€ ä¼šè¯å·¥å‚ï¼šé€šè¿‡ MyBatis çš„ç¯å¢ƒç­‰é…ç½®ä¿¡æ¯æ„å»º<strong>ä¼šè¯å·¥å‚ SqlSessionFactory</strong>ã€‚<br><strong>3.</strong> åˆ›å»ºä¼šè¯å¯¹è±¡ï¼šç”±ä¼šè¯å·¥å‚<strong>åˆ›å»º SqlSession å¯¹è±¡</strong>ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«äº†æ‰§è¡Œ SQL è¯­å¥çš„æ‰€æœ‰æ–¹æ³•ã€‚<br><strong>4.</strong> Executor æ‰§è¡Œå™¨ï¼šMyBatis åº•å±‚å®šä¹‰äº†ä¸€ä¸ª Executor æ¥å£æ¥æ“ä½œæ•°æ®åº“ï¼Œå®ƒå°†æ ¹æ®SqlSession ä¼ é€’çš„å‚æ•°åŠ¨æ€åœ°ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼ŒåŒæ—¶è´Ÿè´£æŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤ã€‚<br><strong>5.</strong> <strong>StatementHandler</strong>ï¼šæ•°æ®åº“ä¼šè¯å™¨ï¼Œä¸²è”èµ·å‚æ•°æ˜ å°„çš„å¤„ç†å’Œè¿è¡Œç»“æœæ˜ å°„çš„å¤„ç†ã€‚<br>**6.**å‚æ•°å¤„ç†ï¼šå¯¹è¾“å…¥å‚æ•°çš„ç±»å‹è¿›è¡Œå¤„ç†ï¼Œå¹¶é¢„ç¼–è¯‘<br>**7.**ç»“æœå¤„ç†ï¼šå¯¹è¿”å›ç»“æœçš„ç±»å‹è¿›è¡Œå¤„ç†ï¼Œæ ¹æ®å¯¹è±¡æ˜ å°„è§„åˆ™ï¼Œè¿”å›ç›¸åº”çš„å¯¹è±¡ã€‚</p>
<h2 id="MyBatisçš„åŠŸèƒ½æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#MyBatisçš„åŠŸèƒ½æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="MyBatisçš„åŠŸèƒ½æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>MyBatisçš„åŠŸèƒ½æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901154447146.png" srcset="/img/loading.gif" lazyload alt="image-20220901154447146"></p>
<p>æˆ‘ä»¬ä¸€èˆ¬æŠŠMybatisçš„åŠŸèƒ½æ¶æ„åˆ†ä¸ºä¸‰å±‚ï¼š</p>
<ul>
<li><strong>APIæ¥å£å±‚</strong>ï¼šæä¾›ç»™å¤–éƒ¨ä½¿ç”¨çš„æ¥åˆAPIï¼Œå¼€å‘äººå‘˜é€šè¿‡è¿™äº›æœ¬åœ°APIæ¥æ“çºµæ•°æ®åº“ã€‚æ¥å£å±‚ä¸€æ¥æ”¶åˆ°è°ƒç”¨è¯·æ±‚å°±ä¼šè°ƒç”¨æ•°æ®å¤„ç†å±‚æ¥å®Œæˆå…·ä½“çš„æ•°æ®å¤„ç†ã€‚</li>
<li><strong>æ•°æ®å¤„ç†å±‚</strong>ï¼šè´Ÿè´£å…·ä½“çš„SQLæŸ¥æ‰¾ã€SQLè§£æã€SQLæ‰§è¡Œå’Œæ‰§è¡Œç»“æœæ˜ å°„å¤„ç†ç­‰ã€‚å®ƒä¸»è¦çš„ç›®çš„æ˜¯æ ¹æ®è°ƒç”¨çš„è¯·æ±‚å®Œæˆä¸€æ¬¡æ•°æ®åº“æ“ä½œã€‚</li>
<li><strong>åŸºç¡€æ”¯æ’‘å±‚</strong>ï¼šè´Ÿè´£æœ€åŸºç¡€çš„åŠŸèƒ½æ”¯æ’‘ï¼ŒåŒ…æ‹¬<strong>è¿æ¥ç®¡ç†ã€äº‹åŠ¡ç®¡ç†ã€é…ç½®åŠ è½½å’Œç¼“å­˜å¤„ç†</strong>ï¼Œè¿™äº›éƒ½æ˜¯å…±ç”¨çš„ä¸œè¥¿ï¼Œå°†ä»–ä»¬æŠ½å–å‡ºæ¥ä½œä¸ºæœ€åŸºç¡€çš„ç»„ä»¶ã€‚ä¸ºä¸Šå±‚çš„æ•°æ®å¤„ç†å±‚æä¾›æœ€åŸºç¡€çš„æ”¯æ’‘ã€‚</li>
</ul>
<h2 id="ä¸ºä»€ä¹ˆMapperæ¥åˆä¸éœ€è¦å®ç°ç±»ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆMapperæ¥åˆä¸éœ€è¦å®ç°ç±»ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆMapperæ¥åˆä¸éœ€è¦å®ç°ç±»ï¼Ÿ"></a>ä¸ºä»€ä¹ˆMapperæ¥åˆä¸éœ€è¦å®ç°ç±»ï¼Ÿ</h2><p>å››ä¸ªå­—å›ç­”ï¼š <strong>åŠ¨æ€ä»£ç†</strong> ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è·å–Mapperçš„è¿‡ç¨‹ï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901155803040.png" srcset="/img/loading.gif" lazyload alt="image-20220901155803040"></p>
<ul>
<li><p>è·å–Mapper<br>æˆ‘ä»¬éƒ½çŸ¥é“å®šä¹‰çš„Mapperæ¥å£æ˜¯æ²¡æœ‰å®ç°ç±»çš„ï¼ŒMapperæ˜ å°„å…¶å®æ˜¯é€šè¿‡ åŠ¨æ€ä»£ç† å®ç°çš„ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">BlogMapper</span> mapper <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">BlogMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>ä¸ƒæ‹å…«ç»•åœ°è¿›å»çœ‹ä¸€ä¸‹ï¼Œå‘ç°è·å–Mapperçš„è¿‡ç¨‹ï¼Œéœ€è¦å…ˆè·å–<strong>MapperProxyFactory</strong>â€”â€”Mapperä»£ç†å·¥å‚ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">T</span> <span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> type<span class="token punctuation">,</span> <span class="token class-name">SqlSession</span> sqlSession<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">MapperProxyFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> mapperProxyFactory <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MapperProxyFactory</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span>knownMappers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mapperProxyFactory <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BindingException</span><span class="token punctuation">(</span><span class="token string">"Type "</span> <span class="token operator">+</span> type <span class="token operator">+</span> " is not known
        <span class="token keyword">to</span> <span class="token namespace">the</span> <span class="token class-name">MapperRegistry</span><span class="token punctuation">.</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> mapperProxyFactory<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var5<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BindingException</span><span class="token punctuation">(</span>"<span class="token class-name">Error</span> getting mapper
        <span class="token class-name"><span class="token namespace">instance<span class="token punctuation">.</span></span> Cause</span><span class="token operator">:</span> " <span class="token operator">+</span> var5<span class="token punctuation">,</span> var5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>MapperProxyFactory<br>MapperProxyFactoryçš„ä½œç”¨æ˜¯ç”ŸæˆMapperProxyï¼ˆMapperä»£ç†å¯¹è±¡ï¼‰ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MapperProxyFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> mapperInterface<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">protected</span> <span class="token class-name">T</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">MapperProxy</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> mapperProxy<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span>
    <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapperInterface<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapperInterface<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 			mapperProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">SqlSession</span> sqlSession<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">MapperProxy</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> mapperProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperProxy</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mapperInterface<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>methodCache<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>mapperProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°åŠ¨æ€ä»£ç†å¯¹æ¥åˆçš„ç»‘å®šï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ï¼ˆå ä½ï¼‰ï¼Œè€Œä»£ç†çš„æ–¹æ³•è¢«æ”¾åˆ°äº†MapperProxyä¸­ã€‚</p>
<ul>
<li>MapperProxy</li>
</ul>
</li>
</ul>
<p>â€‹        MapperProxyé‡Œï¼Œé€šå¸¸ä¼šç”Ÿæˆä¸€ä¸ª<strong>MapperMethod</strong>å¯¹è±¡ï¼Œå®ƒæ˜¯é€šè¿‡cachedMapperMethodæ–¹æ³•å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œç„¶åæ‰§è¡Œexcuteæ–¹        æ³•ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span>
        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cachedInvoker</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span>
        method<span class="token punctuation">,</span> args<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlSession<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var5<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token class-name">ExceptionUtil</span><span class="token punctuation">.</span><span class="token function">unwrapThrowable</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>MapperMethod<br>MapperMethodé‡Œçš„excuteæ–¹æ³•ï¼Œä¼šçœŸæ­£å»æ‰§è¡Œsqlã€‚è¿™é‡Œç”¨åˆ°äº†å‘½ä»¤æ¨¡å¼ï¼Œå…¶å®ç»•ä¸€åœˆï¼Œæœ€ç»ˆå®ƒè¿˜æ˜¯é€šè¿‡<strong>SqlSession</strong>çš„å®ä¾‹å»è¿è¡Œå¯¹è±¡çš„sqlã€‚</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">SqlSession</span> sqlSession<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Object</span> result<span class="token punctuation">;</span>
    <span class="token class-name">Object</span> param<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">case</span> <span class="token constant">SELECT</span><span class="token operator">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">returnsVoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">hasResultHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">executeWithResultHandler</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">returnsMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">executeForMany</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">returnsMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">executeForMap</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">returnsCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">executeForCursor</span><span class="token punctuation">(</span>sqlSession<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    param <span class="token operator">=</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">convertArgsToSqlCommandParam</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span>
    sqlSession<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>command<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">returnsOptional</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span>
    <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    result <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿ"><a href="#Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿ" class="headerlink" title="Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿ"></a>Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿ</h2><p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901162602848.png" srcset="/img/loading.gif" lazyload alt="image-20220901162602848"></p>
<p>Mybatisæœ‰ä¸‰ç§åŸºæœ¬çš„Executoræ‰§è¡Œå™¨ï¼Œ<strong>SimpleExecutorã€ReuseExecutorã€BatchExecutor</strong>ã€‚</p>
<ul>
<li><strong>SimpleExecutor</strong>ï¼šæ¯æ‰§è¡Œä¸€æ¬¡updateæˆ–selectï¼Œå°±å¼€å¯ä¸€ä¸ªStatementå¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­Statementå¯¹è±¡ã€‚</li>
<li><strong>ReuseExecutor</strong>ï¼šæ‰§è¡Œupdateæˆ–selectï¼Œä»¥sqlä½œä¸ºkeyæŸ¥æ‰¾Statementå¯¹è±¡ï¼Œå­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±åˆ›å»ºï¼Œç”¨å®Œåï¼Œä¸å…³é—­Statementå¯¹è±¡ï¼Œè€Œæ˜¯æ”¾ç½®äºMap&lt;String, Statement&gt;å†…ï¼Œä¾›ä¸‹ä¸€æ¬¡ä½¿ç”¨ã€‚ç®€è¨€ä¹‹ï¼Œå°±æ˜¯é‡å¤ä½¿ç”¨Statementå¯¹è±¡ã€‚</li>
<li><strong>BatchExecutor</strong>ï¼šæ‰§è¡Œupdateï¼ˆæ²¡æœ‰selectï¼ŒJDBCæ‰¹å¤„ç†ä¸æ”¯æŒselectï¼‰ï¼Œå°†æ‰€æœ‰sqléƒ½æ·»åŠ åˆ°æ‰¹å¤„ç†ä¸­ï¼ˆaddBatch()ï¼‰ï¼Œç­‰å¾…ç»Ÿä¸€æ‰§è¡Œï¼ˆexecuteBatch()ï¼‰ï¼Œå®ƒç¼“å­˜äº†å¤šä¸ªStatementå¯¹è±¡ï¼Œæ¯ä¸ªStatementå¯¹è±¡éƒ½æ˜¯addBatch()å®Œæ¯•åï¼Œç­‰å¾…é€ä¸€æ‰§è¡ŒexecuteBatch()æ‰¹å¤„ç†ã€‚ä¸JDBCæ‰¹å¤„ç†ç›¸åŒã€‚</li>
</ul>
<p>ä½œç”¨èŒƒå›´ï¼šExecutorçš„è¿™äº›ç‰¹ç‚¹ï¼Œéƒ½ä¸¥æ ¼é™åˆ¶åœ¨SqlSessionç”Ÿå‘½å‘¨æœŸèŒƒå›´å†…ã€‚</p>
<h3 id="Mybatisä¸­å¦‚ä½•æŒ‡å®šä½¿ç”¨å“ªä¸€ç§Executoræ‰§è¡Œå™¨ï¼Ÿ"><a href="#Mybatisä¸­å¦‚ä½•æŒ‡å®šä½¿ç”¨å“ªä¸€ç§Executoræ‰§è¡Œå™¨ï¼Ÿ" class="headerlink" title="Mybatisä¸­å¦‚ä½•æŒ‡å®šä½¿ç”¨å“ªä¸€ç§Executoræ‰§è¡Œå™¨ï¼Ÿ"></a>Mybatisä¸­å¦‚ä½•æŒ‡å®šä½¿ç”¨å“ªä¸€ç§Executoræ‰§è¡Œå™¨ï¼Ÿ</h3><ul>
<li>åœ¨Mybatisé…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨è®¾ç½®ï¼ˆsettingsï¼‰å¯ä»¥æŒ‡å®šé»˜è®¤çš„<strong>ExecutorType</strong>æ‰§è¡Œå™¨ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨ç»™DefaultSqlSessionFactoryçš„åˆ›å»ºSqlSessionçš„æ–¹æ³•ä¼ é€’<strong>ExecutorTypeç±»å‹å‚æ•°</strong>ï¼Œå¦‚SqlSession openSession(ExecutorType execType)ã€‚</li>
<li>é…ç½®é»˜è®¤çš„æ‰§è¡Œå™¨ã€‚<strong>SIMPLE</strong> å°±æ˜¯æ™®é€šçš„æ‰§è¡Œå™¨ï¼›<strong>REUSE</strong> æ‰§è¡Œå™¨ä¼šé‡ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆprepared statementsï¼‰ï¼› <strong>BATCH</strong> æ‰§è¡Œå™¨å°†é‡ç”¨è¯­å¥å¹¶æ‰§è¡Œæ‰¹é‡æ›´æ–°ã€‚</li>
</ul>
<h1 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h1><h2 id="è¯´è¯´Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"><a href="#è¯´è¯´Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ" class="headerlink" title="è¯´è¯´Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"></a>è¯´è¯´Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ</h2><h3 id="æ’ä»¶çš„è¿è¡ŒåŸç†ï¼Ÿ"><a href="#æ’ä»¶çš„è¿è¡ŒåŸç†ï¼Ÿ" class="headerlink" title="æ’ä»¶çš„è¿è¡ŒåŸç†ï¼Ÿ"></a>æ’ä»¶çš„è¿è¡ŒåŸç†ï¼Ÿ</h3><p>Mybatisä¼šè¯çš„è¿è¡Œéœ€è¦ParameterHandlerã€ResultSetHandlerã€StatementHandlerã€Executorè¿™å››å¤§å¯¹è±¡çš„é…åˆï¼Œæ’ä»¶çš„åŸç†å°±æ˜¯åœ¨è¿™å››å¤§å¯¹è±¡è°ƒåº¦çš„æ—¶å€™ï¼Œæ’å…¥ä¸€äº›æˆ‘æˆ‘ä»¬è‡ªå·±çš„ä»£ç ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901163556036.png" srcset="/img/loading.gif" lazyload alt="image-20220901163556036"></p>
<p>Mybatisä½¿ç”¨JDKçš„åŠ¨æ€ä»£ç†ï¼Œä¸ºç›®æ ‡å¯¹è±¡ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå·¥å…·ç±»<strong>Plugin</strong>ï¼Œå®ç°äº†<strong>InvocationHandler</strong>æ¥å£ã€‚</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/image-20220901163645793.png" srcset="/img/loading.gif" lazyload alt="image-20220901163645793"></p>
<p>ä½¿ç”¨Pluginç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šè¿›å…¥invokeæ–¹æ³•ï¼Œåœ¨invokeæ–¹æ³•ä¸­ï¼Œå¦‚æœå­˜åœ¨ç­¾åçš„æ‹¦æˆªæ–¹æ³•ï¼Œæ’ä»¶çš„interceptæ–¹æ³•å°±ä¼šåœ¨è¿™é‡Œè¢«æˆ‘ä»¬è°ƒç”¨ï¼Œç„¶åå°±è¿”å›ç»“æœã€‚å¦‚æœä¸å­˜åœ¨ç­¾åæ–¹æ³•ï¼Œé‚£ä¹ˆå°†ç›´æ¥åå°„è°ƒç”¨æˆ‘ä»¬è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚</p>
<h3 id="å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"><a href="#å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"></a>å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ</h3><p>æˆ‘ä»¬è‡ªå·±ç¼–å†™MyBatis æ’ä»¶ï¼Œåªéœ€è¦å®ç°æ‹¦æˆªå™¨æ¥åˆ Interceptor (org.apache.ibatis. pluginInterceptor ï¼‰ï¼Œåœ¨å®ç°ç±»ä¸­å¯¹æ‹¦æˆªå¯¹è±¡å’Œæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<ul>
<li>å®ç°Mybatisçš„Interceptoræ¥åˆå¹¶é‡å†™intercept()æ–¹æ³•è¿™é‡Œæˆ‘ä»¬åªæ˜¯åœ¨ç›®æ ‡å¯¹è±¡æ‰§è¡Œç›®æ ‡æ–¹æ³•çš„å‰åè¿›è¡Œäº†æ‰“å°ï¼›</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Properties</span> props<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Invocation</span> invocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"before......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å¦‚æœå½“å‰ä»£ç†çš„æ˜¯ä¸€ä¸ªéä»£ç†å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨çœŸå®æ‹¦æˆªå¯¹è±¡çš„æ–¹æ³•</span>
        <span class="token comment">// å¦‚æœä¸æ˜¯å®ƒå°±ä¼šè°ƒç”¨ä¸‹ä¸ªæ’ä»¶ä»£ç†å¯¹è±¡çš„invokeæ–¹æ³•</span>
        <span class="token class-name">Object</span> obj<span class="token operator">=</span>invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"after......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>ç„¶åå†ç»™æ’ä»¶ç¼–å†™æ³¨è§£ï¼Œç¡®å®šè¦æ‹¦æˆªçš„å¯¹è±¡ï¼Œè¦æ‹¦æˆªçš„æ–¹æ³•</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Intercepts</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@Signature</span><span class="token punctuation">(</span>
type <span class="token operator">=</span> <span class="token class-name">Executor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token comment">//ç¡®å®šè¦æ‹¦æˆªçš„å¯¹è±¡</span>
method <span class="token operator">=</span> <span class="token string">"update"</span><span class="token punctuation">,</span> <span class="token comment">//ç¡®å®šè¦æ‹¦æˆªçš„æ–¹æ³•</span>
args <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">MappedStatement</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span> <span class="token comment">//æ‹¦æˆªæ–¹æ³•çš„å‚æ•°</span>
<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Properties</span> props<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Invocation</span> invocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"before......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å¦‚æœå½“å‰ä»£ç†çš„æ˜¯ä¸€ä¸ªéä»£ç†å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨çœŸå®æ‹¦æˆªå¯¹è±¡çš„æ–¹æ³•</span>
        <span class="token comment">// å¦‚æœä¸æ˜¯å®ƒå°±ä¼šè°ƒç”¨ä¸‹ä¸ªæ’ä»¶ä»£ç†å¯¹è±¡çš„invokeæ–¹æ³•</span>
        <span class="token class-name">Object</span> obj<span class="token operator">=</span>invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"after......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>æœ€åï¼Œåœ¨MyBatisé…ç½®æ–‡ä»¶é‡Œé¢é…ç½®æ’ä»¶</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">interceptor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xxx.MyPlugin<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dbType<span class="token punctuation">"</span></span><span class="token attr-name">,value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Mybatis-åˆ†é¡µæ’ä»¶"><a href="#Mybatis-åˆ†é¡µæ’ä»¶" class="headerlink" title="Mybatis-åˆ†é¡µæ’ä»¶"></a>Mybatis-åˆ†é¡µæ’ä»¶</h2><p><strong>åˆ†é¡µæ’ä»¶ï¼š</strong></p>
<p><strong>1.æ·»åŠ ä¾èµ–ï¼š</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.github.pagehelper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>pagehelper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><strong>2.åœ¨mybatisä¸»é…ç½®æ–‡ä»¶ä¸­é…ç½®åˆ†é¡µæ’ä»¶ï¼š</strong></p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/2600280-20220303161626997-395362475.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>åˆ†é¡µæ’ä»¶ä½¿ç”¨ï¼š</strong></p>
<p>ã€€ã€€ä½¿ç”¨mybatisçš„åˆ†é¡µæ’ä»¶å®ç°åˆ†é¡µåŠŸèƒ½ï¼š</p>
<p>ã€€ã€€ã€€ã€€1.éœ€è¦åœ¨æŸ¥è¯¢åŠŸèƒ½ä¹‹å‰å¼€å¯åˆ†é¡µ</p>
<p>ã€€ã€€ã€€ã€€ PageHelper.startPage(2ã€ä»ç¬¬å‡ é¡µå¼€å§‹ã€‘,4ã€æ¯é¡µæ˜¾ç¤ºçš„æ•°æ®ã€‘);</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
     * limit,index,pageSize
     * index:å½“å‰é¡µçš„èµ·å§‹ç´¢å¼•
     * pageSizeï¼šæ¯é¡µæ˜¾ç¤ºçš„ä¿¡æ¯æ¡æ•°
     * pageNumï¼šå½“å‰çš„é¡µç 
     * index=ï¼ˆpageNum-1ï¼‰*pageSixe
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testHelpPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"Mybatis.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SqlSession</span> session <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">EmpMapper</span> mapper <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmpMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PageHelper</span><span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">></span></span> emps <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">></span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>emps<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
            emps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>emp <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>2.åœ¨æŸ¥è¯¢åŠŸèƒ½ç»“æŸåè·å–åˆ†é¡µç›¸å…³ä¿¡æ¯</p>
<p>â€‹        PageInfo<Emp> page = new PageInfo&lt;&gt;(emps,5);è¿›è¡Œå¯¼èˆªåˆ†é¡µ</p>
<p>ã€€ã€€empsï¼šè¡¨ç¤ºåˆ†é¡µæ•°æ®</p>
<p>ã€€ã€€5ï¼šè¡¨ç¤ºå½“å‰å¯¼èˆªåˆ†é¡µçš„æ•°é‡</p>
<p>â€‹        è¿è¡Œç»“æœï¼š</p>
<p><img src="/img/%E9%9D%A2%E8%AF%95-Mybatis/2600280-20220303163713816-2112457012.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>æ˜¾ç¤ºç¬¬äºŒé¡µï¼Œä¸€é¡µ4æ¡æ•°æ®</p>
<p>ç»“æœå…·ä½“åˆ†æï¼š</p>
<p>PageInfo{pageNum=2, pageSize=4, size=4, startRow=5, endRow=8, total=11, pages=3, list=Page{count=true, pageNum=2, pageSize=4, startRow=4, endRow=8, total=11, pages=3, reasonable=false, pageSizeZero=false}prePage=1, nextPage=3, isFirstPage=false, isLastPage=false, hasPreviousPage=true, hasNextPage=true, navigatePages=5, navigateFirstPage=1, navigateLastPage=3, navigatepageNums=[1, 2, 3]}</p>
<table>
<thead>
<tr>
<th align="left"><strong>pageNum=2è¡¨ç¤ºå½“å‰é¡µç æ•°</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>pageSize=4ï¼šè¡¨ç¤ºä¸€é¡µçš„æ•°æ®</strong></td>
</tr>
<tr>
<td align="left"><strong>size=4ï¼šè¿™ç¬¬äºŒé¡µçš„çœŸå®æ•°æ®ä¸ªæ•°</strong></td>
</tr>
<tr>
<td align="left"><strong>startRow=5ï¼šç¬¬äºŒé¡µå››ä¸ªæ•°æ®ä»æ•°æ®åº“è¡¨å•ä¸­ç¬¬5ä¸ªæ•°æ®å¼€å§‹</strong></td>
</tr>
<tr>
<td align="left"><strong>endRow=8ï¼šç¬¬äºŒé¡µå››ä¸ªæ•°æ®ä»æ•°æ®åº“è¡¨å•ä¸­ç¬¬8ä¸ªæ•°æ®ç»“æŸ</strong></td>
</tr>
<tr>
<td align="left"><strong>total=11ï¼šæ•°æ®åº“è¡¨å•æ€»æ•°æ®æ¡æ•°</strong></td>
</tr>
<tr>
<td align="left"><strong>pages=3ï¼šæ€»é¡µæ•°</strong></td>
</tr>
<tr>
<td align="left"><strong>prePage=1ï¼šè¿™é¡µçš„ä¸Šä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>nextPage=3ï¼šè¿™é¡µçš„ä¸‹ä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>isFirstPage=falseï¼šåˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>isLastPage=falseï¼šåˆ¤æ–­æ˜¯å¦æ˜¯æœ€åä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>hasPreviousPage=trueï¼šæ˜¯å¦æœ‰ä¸Šä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>hasNextPage=trueï¼šæ˜¯å¦æœ‰ä¸‹ä¸€é¡µ</strong></td>
</tr>
<tr>
<td align="left"><strong>navigatePages=5ï¼šè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬åœ¨æ–¹æ³•ä¸­è¾“å…¥çš„å‚æ•°ï¼ˆPageInfo<Emp> page = new PageInfo&lt;&gt;(emps,5);ï¼‰</strong></td>
</tr>
<tr>
<td align="left"><strong><em>navigateFirstPage=1ï¼šå¯¼èˆªåˆ†é¡µä»ç¬¬1é¡µå¼€å§‹</em></strong></td>
</tr>
<tr>
<td align="left"><strong><em>navigateLastPage=3ï¼šå¯¼èˆªåˆ†é¡µä»ç¬¬3é¡µç»“æŸ</em></strong></td>
</tr>
<tr>
<td align="left"><strong><em>navigatepageNums=[1, 2, 3]ï¼šè¿›è¡Œåº•å±‚è¿ç®—ï¼Œè®¡ç®—å‡ºå¯¼èˆªåˆ†é¡µé¡µç </em></strong></td>
</tr>
</tbody></table>
<p><strong>æ€»ç»“:</strong></p>
<p>ã€€ã€€<strong>a&gt;åœ¨æŸ¥è¯¢åŠŸèƒ½ä¹‹å‰ä½¿ç”¨PageHelper.startPage(int pageNum, int pageSize)å¼€å¯åˆ†é¡µåŠŸèƒ½</strong></p>
<p>ã€€ã€€ã€€ã€€pageNumï¼šå½“å‰é¡µçš„é¡µç         pageSizeï¼šæ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°</p>
<p>ã€€ã€€<strong>b&gt;åœ¨æŸ¥è¯¢è·å–listé›†åˆä¹‹åï¼Œä½¿ç”¨PageInfo pageInfo = new PageInfo&lt;&gt;(List list, int navigatePages)è·å–åˆ†é¡µç›¸å…³æ•°æ®</strong></p>
<p>ã€€ã€€ã€€ã€€ listï¼šåˆ†é¡µä¹‹åçš„æ•°æ®         navigatePagesï¼šå¯¼èˆªåˆ†é¡µçš„é¡µç æ•°</p>
<p>ã€€ã€€<strong>c&gt;åˆ†é¡µç›¸å…³æ•°æ®</strong></p>
<p>ã€€ã€€ã€€ã€€PageInfo{ pageNum=8, pageSize=4, size=2, startRow=29, endRow=30, total=30, pages=8, list=Page{count=true, pageNum=8, pageSize=4, startRow=28, endRow=32, total=30, pages=8, reasonable=false, pageSizeZero=false}, prePage=7, nextPage=0, isFirstPage=false, isLastPage=true, hasPreviousPage=true, hasNextPage=false, navigatePages=5, navigateFirstPage4, navigateLastPage8, navigatepageNums=[4, 5, 6, 7, 8] }*</p>
<h3 id="MyBatisæ˜¯å¦‚ä½•åˆ†é¡µçš„ï¼Ÿ"><a href="#MyBatisæ˜¯å¦‚ä½•åˆ†é¡µçš„ï¼Ÿ" class="headerlink" title="MyBatisæ˜¯å¦‚ä½•åˆ†é¡µçš„ï¼Ÿ"></a>MyBatisæ˜¯å¦‚ä½•åˆ†é¡µçš„ï¼Ÿ</h3><p>MyBatisä½¿ç”¨RowBoundså¯¹è±¡è¿›è¡Œåˆ†é¡µï¼Œå®ƒæ˜¯é’ˆå¯¹ResultSetç»“æœé›†æ‰§è¡Œçš„å†…å­˜åˆ†é¡µï¼Œè€Œéç‰©ç†åˆ†é¡µã€‚å¯ä»¥åœ¨sqlå†…ç›´æ¥ä¹¦å†™å¸¦æœ‰ç‰©ç†åˆ†é¡µçš„å‚æ•°æ¥å®Œæˆç‰©ç†åˆ†é¡µåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ†é¡µæ’ä»¶æ¥å®Œæˆç‰©ç†åˆ†é¡µã€‚</p>
<h3 id="åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul>
<li>åˆ†é¡µæ’ä»¶çš„åŸºæœ¬åŸç†æ˜¯ä½¿ç”¨Mybatisæä¾›çš„æ’ä»¶æ¥å£ï¼Œå®ç°è‡ªå®šä¹‰æ’ä»¶ï¼Œæ‹¦æˆªExecutorçš„queryæ–¹æ³•</li>
<li>åœ¨æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œæ‹¦æˆªå¾…æ‰§è¡Œçš„sqlï¼Œç„¶åé‡å†™sqlï¼Œæ ¹æ®dialectæ–¹è¨€ï¼Œæ·»åŠ å¯¹åº”çš„ç‰©ç†åˆ†é¡µè¯­å¥å’Œç‰©ç†åˆ†é¡µå‚æ•°ã€‚</li>
<li>ä¸¾ä¾‹ï¼šselect * from studentï¼Œæ‹¦æˆªsqlåé‡å†™ä¸ºï¼šselect t.* from (select * from student) t limit 0, 10</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E9%9D%A2%E8%AF%95/" class="category-chain-item">é¢è¯•</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E9%9D%A2%E8%AF%95/">#é¢è¯•</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>é¢è¯•-Mybatis</div>
      <div>https://weishao-996.github.io/2022/08/31/é¢è¯•-Mybatis/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Wei Shao</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´8æœˆ31æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/02/%E9%9D%A2%E8%AF%95-Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" title="é¢è¯•-Javaå¹¶å‘ç¼–ç¨‹">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">é¢è¯•-Javaå¹¶å‘ç¼–ç¨‹</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/29/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85-JDK/" title="è½¯ä»¶å®‰è£…-JDK">
                        <span class="hidden-mobile">è½¯ä»¶å®‰è£…-JDK</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'weishao-996/commit-utterance');
      s.setAttribute('issue-term', 'title');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-left: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="é¢è¯•"
        id="heading-1573c74e227f14ded2daa71bb049ecda" role="tab" data-toggle="collapse" href="#collapse-1573c74e227f14ded2daa71bb049ecda"
        aria-expanded="true"
      >
        é¢è¯•
        <span class="list-group-count">(6)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-1573c74e227f14ded2daa71bb049ecda"
           role="tabpanel" aria-labelledby="heading-1573c74e227f14ded2daa71bb049ecda">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2022/09/06/%E9%9D%A2%E8%AF%95-Java%E5%9F%BA%E7%A1%80/" title="é¢è¯•-JavaåŸºç¡€"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">é¢è¯•-JavaåŸºç¡€</span>
        </a>
      
    
      
      
        <a href="/2022/09/12/%E9%9D%A2%E8%AF%95-Java%E5%AE%B9%E5%99%A8/" title="é¢è¯•-Javaå®¹å™¨"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">é¢è¯•-Javaå®¹å™¨</span>
        </a>
      
    
      
      
        <a href="/2022/09/02/%E9%9D%A2%E8%AF%95-Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" title="é¢è¯•-Javaå¹¶å‘ç¼–ç¨‹"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">é¢è¯•-Javaå¹¶å‘ç¼–ç¨‹</span>
        </a>
      
    
      
      
        <a href="/2022/08/31/%E9%9D%A2%E8%AF%95-Mybatis/" title="é¢è¯•-Mybatis"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">é¢è¯•-Mybatis</span>
        </a>
      
    
      
      
        <a href="/2022/09/08/%E9%9D%A2%E8%AF%95-MySQL/" title="é¢è¯•-Mysql"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">é¢è¯•-Mysql</span>
        </a>
      
    
      
      
        <a href="/2022/08/29/%E9%9D%A2%E8%AF%95-Spring/" title="é¢è¯•-Spring"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">é¢è¯•-Spring</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
